[NbConvertApp] WARNING | Config option `kernel_spec_manager_class` not recognized by `NbConvertApp`.
[NbConvertApp] Converting notebook ../notebooks/train_binary_model.ipynb to script
[NbConvertApp] Writing 18688 bytes to train_binary_model.py
[NbConvertApp] Converting notebook ../notebooks/train_multiclass_model.ipynb to script
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: MissingIDFieldWarning: Code cell is missing an id field, this will become a hard error in future nbformat versions. You may want to use `normalize()` on your notebooks before validations (available since nbformat 5.1.4). Previous versions of nbformat are fixing this issue transparently, and will stop doing so in the future.
  validate(nb)
[NbConvertApp] Writing 31143 bytes to train_multiclass_model.py
[NbConvertApp] Converting notebook ../notebooks/train_regression_model.ipynb to script
[NbConvertApp] Writing 25120 bytes to train_regression_model.py
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/train_multiclass_model.py:314: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_labels.drop_duplicates(inplace=True)
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1015: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y1], palette="blue", label="Train")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1016: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y2], palette="orange", label="Validation")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1015: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y1], palette="blue", label="Train")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1016: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y2], palette="orange", label="Validation")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1036: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/train_multiclass_model.py:578: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_labels["new_labels"] = df_labels["new_labels"].astype(str)
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/train_multiclass_model.py:652: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_labels["new_labels"] = df_labels["new_labels"].astype(str)
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1219: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/train_multiclass_model.py:880: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_labels["new_labels"] = df_labels["new_labels"].astype(str)
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1219: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/train_multiclass_model.py:1096: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_labels["new_labels"] = df_labels["new_labels"].astype(str)
SHSY5Y MultiClass_MLP False
[0.954878893196544, 0.4803479499984947, 0.5647731568049614]
Data Subset Is Off
(165097,) (41275,) (240629,) (150901,)
(165097,) (41275,) (240629,) (150901,)
597902
(7972,) (93463,) (63662,)
(1993,) (23367,) (15915,)
(9965,) (116830,) (113834,)
(7048,) (77041,) (66812,)
(165097, 1251) (41275, 1251) (240629, 1251) (150901, 1251)
(165097,) (41275,) (240629,) (150901,)
Number of in features:  1251
Number of out features:  3
Multi_Class
Adam
Epoch 0: Validation loss decreased (inf --> 0.799634).  Saving model ...
	 Train_Loss: 0.8281 Train_Acc: 63.809 Val_Loss: 0.7996  BEST VAL Loss: 0.7996  Val_Acc: 66.869

Epoch 1: Validation loss did not decrease
	 Train_Loss: 0.8402 Train_Acc: 63.895 Val_Loss: 0.8417  BEST VAL Loss: 0.7996  Val_Acc: 59.799

Epoch 2: Validation loss did not decrease
	 Train_Loss: 0.8568 Train_Acc: 60.962 Val_Loss: 0.8569  BEST VAL Loss: 0.7996  Val_Acc: 60.807

Epoch 3: Validation loss did not decrease
	 Train_Loss: 0.8635 Train_Acc: 62.217 Val_Loss: 0.8626  BEST VAL Loss: 0.7996  Val_Acc: 63.300

Epoch 4: Validation loss did not decrease
	 Train_Loss: 0.8669 Train_Acc: 61.689 Val_Loss: 0.8677  BEST VAL Loss: 0.7996  Val_Acc: 57.110

Epoch 5: Validation loss did not decrease
	 Train_Loss: 0.8699 Train_Acc: 58.573 Val_Loss: 0.8688  BEST VAL Loss: 0.7996  Val_Acc: 58.457

Epoch 6: Validation loss did not decrease
	 Train_Loss: 0.8730 Train_Acc: 58.534 Val_Loss: 0.8704  BEST VAL Loss: 0.7996  Val_Acc: 60.618

Epoch 7: Validation loss did not decrease
	 Train_Loss: 0.8742 Train_Acc: 62.701 Val_Loss: 0.8704  BEST VAL Loss: 0.7996  Val_Acc: 63.440

Epoch 8: Validation loss did not decrease
	 Train_Loss: 0.8747 Train_Acc: 62.173 Val_Loss: 0.8708  BEST VAL Loss: 0.7996  Val_Acc: 60.073

Epoch 9: Validation loss did not decrease
	 Train_Loss: 0.8754 Train_Acc: 62.848 Val_Loss: 0.8705  BEST VAL Loss: 0.7996  Val_Acc: 65.396

Epoch 10: Validation loss did not decrease
	 Train_Loss: 0.8761 Train_Acc: 62.772 Val_Loss: 0.8706  BEST VAL Loss: 0.7996  Val_Acc: 63.540

Epoch 11: Validation loss did not decrease
	 Train_Loss: 0.8774 Train_Acc: 61.374 Val_Loss: 0.8715  BEST VAL Loss: 0.7996  Val_Acc: 61.742

Epoch 12: Validation loss did not decrease
	 Train_Loss: 0.8780 Train_Acc: 62.115 Val_Loss: 0.8712  BEST VAL Loss: 0.7996  Val_Acc: 63.859

Epoch 13: Validation loss did not decrease
	 Train_Loss: 0.8786 Train_Acc: 61.913 Val_Loss: 0.8719  BEST VAL Loss: 0.7996  Val_Acc: 63.266

Epoch 14: Validation loss did not decrease
	 Train_Loss: 0.8790 Train_Acc: 62.287 Val_Loss: 0.8723  BEST VAL Loss: 0.7996  Val_Acc: 63.174

Epoch 15: Validation loss did not decrease
	 Train_Loss: 0.8793 Train_Acc: 62.741 Val_Loss: 0.8726  BEST VAL Loss: 0.7996  Val_Acc: 64.412

Epoch 16: Validation loss did not decrease
Early stopped at epoch : 16
MultiClass_MLP
              precision    recall  f1-score   support

           0       0.85      0.16      0.26      7972
           1       0.66      0.89      0.76     93463
           2       0.72      0.43      0.54     63662

    accuracy                           0.67    165097
   macro avg       0.74      0.49      0.52    165097
weighted avg       0.69      0.67      0.65    165097

MultiClass_MLP
              precision    recall  f1-score   support

           0       0.83      0.16      0.27      1993
           1       0.66      0.88      0.75     23367
           2       0.71      0.42      0.53     15915

    accuracy                           0.67     41275
   macro avg       0.73      0.49      0.52     41275
weighted avg       0.68      0.67      0.64     41275

MultiClass_MLP
              precision    recall  f1-score   support

           0       0.80      0.15      0.26      9965
           1       0.58      0.88      0.70    116830
           2       0.78      0.42      0.55    113834

    accuracy                           0.63    240629
   macro avg       0.72      0.49      0.50    240629
weighted avg       0.69      0.63      0.61    240629

Precision for class 0: 0.7994736842105263
Recall for class 0: 0.15243351731058705
Precision for class 1: 0.5828033019825428
Recall for class 1: 0.8846957117178806
Precision for class 2: 0.7798830256919894
Recall for class 2: 0.4205246235746789
3
              precision    recall  f1-score   support

           0       0.80      0.15      0.26      9965
           1       0.58      0.88      0.70    116830
           2       0.78      0.42      0.55    113834

    accuracy                           0.63    240629
   macro avg       0.72      0.49      0.50    240629
weighted avg       0.69      0.63      0.61    240629

MultiClass_MLP
              precision    recall  f1-score   support

           0       0.83      0.13      0.23      7048
           1       0.61      0.88      0.72     77041
           2       0.77      0.44      0.56     66812

    accuracy                           0.65    150901
   macro avg       0.73      0.49      0.50    150901
weighted avg       0.69      0.65      0.63    150901

Precision for class 0: 0.8263525305410122
Recall for class 0: 0.13436435868331442
Precision for class 1: 0.6113308046162538
Recall for class 1: 0.8849184200620449
Precision for class 2: 0.7665289256198347
Recall for class 2: 0.4386786804765611
3
              precision    recall  f1-score   support

           0       0.83      0.13      0.23      7048
           1       0.61      0.88      0.72     77041
           2       0.77      0.44      0.56     66812

    accuracy                           0.65    150901
   macro avg       0.73      0.49      0.50    150901
weighted avg       0.69      0.65      0.63    150901

Done
