[NbConvertApp] WARNING | Config option `kernel_spec_manager_class` not recognized by `NbConvertApp`.
[NbConvertApp] Converting notebook ../notebooks/Hyperparameter_Optimization_model_multi-class.ipynb to script
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3e2c848c' detected. Corrected to 'a489681d'.
  validate(nb)
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3c53f7e4' detected. Corrected to '42a9bb41'.
  validate(nb)
[NbConvertApp] Writing 14456 bytes to Hyperparameter_Optimization_model_multi-class.py
[NbConvertApp] Converting notebook ../notebooks/Hyperparameter_Optimization_model_regression.ipynb to script
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3e2c848c' detected. Corrected to '5fe215ee'.
  validate(nb)
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3c53f7e4' detected. Corrected to 'fd91db77'.
  validate(nb)
[NbConvertApp] Writing 12852 bytes to Hyperparameter_Optimization_model_regression.py
[NbConvertApp] Converting notebook ../notebooks/train_binary_model.ipynb to script
[NbConvertApp] Writing 19547 bytes to train_binary_model.py
cell_type: SHSY5Y control_name: LPS_0.100_DMSO_0.025 treatment_name: DMSO_0.100_DMSO_0.025 shuffle: True
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:997: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y1], palette="blue", label="Train")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:998: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y2], palette="orange", label="Validation")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:997: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y1], palette="blue", label="Train")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:998: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y2], palette="orange", label="Validation")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1018: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1324: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1324: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
CELL_TYPE: SHSY5Y
CONTROL_NAME: LPS_0.100_DMSO_0.025
TREATMENT_NAME: DMSO_0.100_DMSO_0.025
SHUFFLE: True
True
Selected Catagories are:
['DMSO_0.100_DMSO_0.025' 'LPS_0.100_DMSO_0.025']
The dimensions of the data are: (53153, 1276)
Number of total missing values across all columns: 106306
Data Subset Is Off
Wells held out for testing: ['C20' 'I14']
Wells to use for training, validation, and testing ['B14' 'C14' 'B15' 'C15' 'C16' 'C17' 'C21' 'J14' 'I15' 'J15']
Number of in features:  1251
Number of out features:  2
Binary_Classification
SGD
Epoch 0: Validation loss decreased (inf --> 0.600897).  Saving model ...
	 Train_Loss: 0.6424 Train_Acc: 64.722 Val_Loss: 0.6009  BEST VAL Loss: 0.6009  Val_Acc: 70.191

Epoch 1: Validation loss decreased (0.600897 --> 0.598328).  Saving model ...
	 Train_Loss: 0.6227 Train_Acc: 70.213 Val_Loss: 0.5983  BEST VAL Loss: 0.5983  Val_Acc: 70.214

Epoch 2: Validation loss decreased (0.598328 --> 0.594423).  Saving model ...
	 Train_Loss: 0.6133 Train_Acc: 70.222 Val_Loss: 0.5944  BEST VAL Loss: 0.5944  Val_Acc: 70.214

Epoch 3: Validation loss decreased (0.594423 --> 0.592130).  Saving model ...
	 Train_Loss: 0.6065 Train_Acc: 70.339 Val_Loss: 0.5921  BEST VAL Loss: 0.5921  Val_Acc: 70.260

Epoch 4: Validation loss decreased (0.592130 --> 0.589350).  Saving model ...
	 Train_Loss: 0.6010 Train_Acc: 70.658 Val_Loss: 0.5893  BEST VAL Loss: 0.5893  Val_Acc: 70.328

Epoch 5: Validation loss decreased (0.589350 --> 0.587651).  Saving model ...
	 Train_Loss: 0.5966 Train_Acc: 70.928 Val_Loss: 0.5877  BEST VAL Loss: 0.5877  Val_Acc: 70.510

Epoch 6: Validation loss decreased (0.587651 --> 0.585375).  Saving model ...
	 Train_Loss: 0.5930 Train_Acc: 71.313 Val_Loss: 0.5854  BEST VAL Loss: 0.5854  Val_Acc: 71.240

Epoch 7: Validation loss decreased (0.585375 --> 0.583124).  Saving model ...
	 Train_Loss: 0.5898 Train_Acc: 71.652 Val_Loss: 0.5831  BEST VAL Loss: 0.5831  Val_Acc: 71.490

Epoch 8: Validation loss decreased (0.583124 --> 0.581618).  Saving model ...
	 Train_Loss: 0.5872 Train_Acc: 71.903 Val_Loss: 0.5816  BEST VAL Loss: 0.5816  Val_Acc: 71.468

Epoch 9: Validation loss decreased (0.581618 --> 0.580316).  Saving model ...
	 Train_Loss: 0.5847 Train_Acc: 72.014 Val_Loss: 0.5803  BEST VAL Loss: 0.5803  Val_Acc: 71.764

Epoch 10: Validation loss decreased (0.580316 --> 0.578959).  Saving model ...
	 Train_Loss: 0.5824 Train_Acc: 71.903 Val_Loss: 0.5790  BEST VAL Loss: 0.5790  Val_Acc: 71.673

Epoch 11: Validation loss decreased (0.578959 --> 0.577932).  Saving model ...
	 Train_Loss: 0.5801 Train_Acc: 72.094 Val_Loss: 0.5779  BEST VAL Loss: 0.5779  Val_Acc: 71.490

Epoch 12: Validation loss decreased (0.577932 --> 0.577024).  Saving model ...
	 Train_Loss: 0.5781 Train_Acc: 72.467 Val_Loss: 0.5770  BEST VAL Loss: 0.5770  Val_Acc: 71.878

Epoch 13: Validation loss decreased (0.577024 --> 0.576381).  Saving model ...
	 Train_Loss: 0.5762 Train_Acc: 72.362 Val_Loss: 0.5764  BEST VAL Loss: 0.5764  Val_Acc: 71.468

Epoch 14: Validation loss decreased (0.576381 --> 0.575508).  Saving model ...
	 Train_Loss: 0.5745 Train_Acc: 72.450 Val_Loss: 0.5755  BEST VAL Loss: 0.5755  Val_Acc: 71.787

Epoch 15: Validation loss decreased (0.575508 --> 0.574860).  Saving model ...
	 Train_Loss: 0.5728 Train_Acc: 72.570 Val_Loss: 0.5749  BEST VAL Loss: 0.5749  Val_Acc: 71.285

Epoch 16: Validation loss decreased (0.574860 --> 0.573982).  Saving model ...
	 Train_Loss: 0.5712 Train_Acc: 72.780 Val_Loss: 0.5740  BEST VAL Loss: 0.5740  Val_Acc: 72.151

Epoch 17: Validation loss decreased (0.573982 --> 0.573406).  Saving model ...
	 Train_Loss: 0.5695 Train_Acc: 72.789 Val_Loss: 0.5734  BEST VAL Loss: 0.5734  Val_Acc: 71.855

Epoch 18: Validation loss decreased (0.573406 --> 0.572464).  Saving model ...
	 Train_Loss: 0.5682 Train_Acc: 72.618 Val_Loss: 0.5725  BEST VAL Loss: 0.5725  Val_Acc: 71.878

Epoch 19: Validation loss decreased (0.572464 --> 0.572127).  Saving model ...
	 Train_Loss: 0.5668 Train_Acc: 72.837 Val_Loss: 0.5721  BEST VAL Loss: 0.5721  Val_Acc: 71.809

Epoch 20: Validation loss decreased (0.572127 --> 0.571732).  Saving model ...
	 Train_Loss: 0.5654 Train_Acc: 72.843 Val_Loss: 0.5717  BEST VAL Loss: 0.5717  Val_Acc: 71.536

Epoch 21: Validation loss decreased (0.571732 --> 0.571253).  Saving model ...
	 Train_Loss: 0.5641 Train_Acc: 72.823 Val_Loss: 0.5713  BEST VAL Loss: 0.5713  Val_Acc: 72.015

Epoch 22: Validation loss decreased (0.571253 --> 0.570557).  Saving model ...
	 Train_Loss: 0.5628 Train_Acc: 73.071 Val_Loss: 0.5706  BEST VAL Loss: 0.5706  Val_Acc: 72.083

Epoch 23: Validation loss decreased (0.570557 --> 0.569887).  Saving model ...
	 Train_Loss: 0.5617 Train_Acc: 72.983 Val_Loss: 0.5699  BEST VAL Loss: 0.5699  Val_Acc: 72.083

Epoch 24: Validation loss decreased (0.569887 --> 0.569695).  Saving model ...
	 Train_Loss: 0.5606 Train_Acc: 73.065 Val_Loss: 0.5697  BEST VAL Loss: 0.5697  Val_Acc: 72.356

Epoch 25: Validation loss did not decrease
	 Train_Loss: 0.5594 Train_Acc: 73.248 Val_Loss: 0.5697  BEST VAL Loss: 0.5697  Val_Acc: 71.308

Epoch 26: Validation loss decreased (0.569695 --> 0.569472).  Saving model ...
	 Train_Loss: 0.5583 Train_Acc: 73.453 Val_Loss: 0.5695  BEST VAL Loss: 0.5695  Val_Acc: 71.809

Epoch 27: Validation loss decreased (0.569472 --> 0.568913).  Saving model ...
	 Train_Loss: 0.5572 Train_Acc: 73.313 Val_Loss: 0.5689  BEST VAL Loss: 0.5689  Val_Acc: 72.197

Epoch 28: Validation loss decreased (0.568913 --> 0.568511).  Saving model ...
	 Train_Loss: 0.5562 Train_Acc: 73.504 Val_Loss: 0.5685  BEST VAL Loss: 0.5685  Val_Acc: 72.174

Epoch 29: Validation loss decreased (0.568511 --> 0.568108).  Saving model ...
	 Train_Loss: 0.5551 Train_Acc: 73.364 Val_Loss: 0.5681  BEST VAL Loss: 0.5681  Val_Acc: 72.334

Epoch 30: Validation loss decreased (0.568108 --> 0.567753).  Saving model ...
	 Train_Loss: 0.5542 Train_Acc: 73.299 Val_Loss: 0.5678  BEST VAL Loss: 0.5678  Val_Acc: 72.197

Epoch 31: Validation loss decreased (0.567753 --> 0.567411).  Saving model ...
	 Train_Loss: 0.5533 Train_Acc: 73.618 Val_Loss: 0.5674  BEST VAL Loss: 0.5674  Val_Acc: 71.513

Epoch 32: Validation loss decreased (0.567411 --> 0.566938).  Saving model ...
	 Train_Loss: 0.5524 Train_Acc: 73.547 Val_Loss: 0.5669  BEST VAL Loss: 0.5669  Val_Acc: 72.242

Epoch 33: Validation loss decreased (0.566938 --> 0.566696).  Saving model ...
	 Train_Loss: 0.5515 Train_Acc: 73.695 Val_Loss: 0.5667  BEST VAL Loss: 0.5667  Val_Acc: 71.741

Epoch 34: Validation loss decreased (0.566696 --> 0.566657).  Saving model ...
	 Train_Loss: 0.5506 Train_Acc: 73.667 Val_Loss: 0.5667  BEST VAL Loss: 0.5667  Val_Acc: 71.582

Epoch 35: Validation loss decreased (0.566657 --> 0.566391).  Saving model ...
	 Train_Loss: 0.5497 Train_Acc: 73.604 Val_Loss: 0.5664  BEST VAL Loss: 0.5664  Val_Acc: 72.242

Epoch 36: Validation loss decreased (0.566391 --> 0.566209).  Saving model ...
	 Train_Loss: 0.5488 Train_Acc: 73.866 Val_Loss: 0.5662  BEST VAL Loss: 0.5662  Val_Acc: 72.106

Epoch 37: Validation loss decreased (0.566209 --> 0.565813).  Saving model ...
	 Train_Loss: 0.5480 Train_Acc: 73.954 Val_Loss: 0.5658  BEST VAL Loss: 0.5658  Val_Acc: 72.197

Epoch 38: Validation loss decreased (0.565813 --> 0.565542).  Saving model ...
	 Train_Loss: 0.5472 Train_Acc: 73.877 Val_Loss: 0.5655  BEST VAL Loss: 0.5655  Val_Acc: 71.901

Epoch 39: Validation loss decreased (0.565542 --> 0.565267).  Saving model ...
	 Train_Loss: 0.5463 Train_Acc: 73.863 Val_Loss: 0.5653  BEST VAL Loss: 0.5653  Val_Acc: 72.129

Epoch 40: Validation loss decreased (0.565267 --> 0.565047).  Saving model ...
	 Train_Loss: 0.5456 Train_Acc: 74.117 Val_Loss: 0.5650  BEST VAL Loss: 0.5650  Val_Acc: 71.673

Epoch 41: Validation loss decreased (0.565047 --> 0.564811).  Saving model ...
	 Train_Loss: 0.5448 Train_Acc: 73.746 Val_Loss: 0.5648  BEST VAL Loss: 0.5648  Val_Acc: 71.923

Epoch 42: Validation loss decreased (0.564811 --> 0.564517).  Saving model ...
	 Train_Loss: 0.5441 Train_Acc: 73.960 Val_Loss: 0.5645  BEST VAL Loss: 0.5645  Val_Acc: 72.425

Epoch 43: Validation loss decreased (0.564517 --> 0.564234).  Saving model ...
	 Train_Loss: 0.5433 Train_Acc: 74.151 Val_Loss: 0.5642  BEST VAL Loss: 0.5642  Val_Acc: 72.334

Epoch 44: Validation loss decreased (0.564234 --> 0.563938).  Saving model ...
	 Train_Loss: 0.5426 Train_Acc: 74.017 Val_Loss: 0.5639  BEST VAL Loss: 0.5639  Val_Acc: 72.448

Epoch 45: Validation loss did not decrease
	 Train_Loss: 0.5419 Train_Acc: 74.142 Val_Loss: 0.5640  BEST VAL Loss: 0.5639  Val_Acc: 71.468

Epoch 46: Validation loss did not decrease
	 Train_Loss: 0.5412 Train_Acc: 74.216 Val_Loss: 0.5641  BEST VAL Loss: 0.5639  Val_Acc: 71.536

Epoch 47: Validation loss did not decrease
	 Train_Loss: 0.5405 Train_Acc: 73.994 Val_Loss: 0.5641  BEST VAL Loss: 0.5639  Val_Acc: 71.650

Epoch 48: Validation loss did not decrease
	 Train_Loss: 0.5398 Train_Acc: 74.074 Val_Loss: 0.5640  BEST VAL Loss: 0.5639  Val_Acc: 72.402

Epoch 49: Validation loss decreased (0.563938 --> 0.563902).  Saving model ...
	 Train_Loss: 0.5392 Train_Acc: 74.251 Val_Loss: 0.5639  BEST VAL Loss: 0.5639  Val_Acc: 71.878

Epoch 50: Validation loss decreased (0.563902 --> 0.563635).  Saving model ...
	 Train_Loss: 0.5384 Train_Acc: 74.402 Val_Loss: 0.5636  BEST VAL Loss: 0.5636  Val_Acc: 71.764

Epoch 51: Validation loss decreased (0.563635 --> 0.563505).  Saving model ...
	 Train_Loss: 0.5378 Train_Acc: 74.450 Val_Loss: 0.5635  BEST VAL Loss: 0.5635  Val_Acc: 72.379

Epoch 52: Validation loss did not decrease
	 Train_Loss: 0.5371 Train_Acc: 74.251 Val_Loss: 0.5636  BEST VAL Loss: 0.5635  Val_Acc: 72.197

Epoch 53: Validation loss did not decrease
	 Train_Loss: 0.5364 Train_Acc: 74.231 Val_Loss: 0.5636  BEST VAL Loss: 0.5635  Val_Acc: 71.741

Epoch 54: Validation loss did not decrease
	 Train_Loss: 0.5358 Train_Acc: 74.467 Val_Loss: 0.5637  BEST VAL Loss: 0.5635  Val_Acc: 71.809

Epoch 55: Validation loss did not decrease
	 Train_Loss: 0.5352 Train_Acc: 74.202 Val_Loss: 0.5635  BEST VAL Loss: 0.5635  Val_Acc: 72.197

Epoch 56: Validation loss did not decrease
	 Train_Loss: 0.5346 Train_Acc: 74.396 Val_Loss: 0.5638  BEST VAL Loss: 0.5635  Val_Acc: 71.696

Epoch 57: Validation loss did not decrease
	 Train_Loss: 0.5339 Train_Acc: 74.496 Val_Loss: 0.5637  BEST VAL Loss: 0.5635  Val_Acc: 72.402

Epoch 58: Validation loss did not decrease
	 Train_Loss: 0.5333 Train_Acc: 74.402 Val_Loss: 0.5638  BEST VAL Loss: 0.5635  Val_Acc: 71.855

Epoch 59: Validation loss did not decrease
	 Train_Loss: 0.5327 Train_Acc: 74.373 Val_Loss: 0.5637  BEST VAL Loss: 0.5635  Val_Acc: 72.311

Epoch 60: Validation loss did not decrease
	 Train_Loss: 0.5321 Train_Acc: 74.396 Val_Loss: 0.5635  BEST VAL Loss: 0.5635  Val_Acc: 72.265

Epoch 61: Validation loss did not decrease
	 Train_Loss: 0.5315 Train_Acc: 74.473 Val_Loss: 0.5636  BEST VAL Loss: 0.5635  Val_Acc: 71.536

Epoch 62: Validation loss did not decrease
	 Train_Loss: 0.5310 Train_Acc: 74.333 Val_Loss: 0.5636  BEST VAL Loss: 0.5635  Val_Acc: 72.516

Epoch 63: Validation loss did not decrease
	 Train_Loss: 0.5304 Train_Acc: 74.738 Val_Loss: 0.5637  BEST VAL Loss: 0.5635  Val_Acc: 72.242

Epoch 64: Validation loss did not decrease
	 Train_Loss: 0.5299 Train_Acc: 74.390 Val_Loss: 0.5636  BEST VAL Loss: 0.5635  Val_Acc: 72.334

Epoch 65: Validation loss did not decrease
	 Train_Loss: 0.5293 Train_Acc: 74.709 Val_Loss: 0.5639  BEST VAL Loss: 0.5635  Val_Acc: 71.536

Epoch 66: Validation loss did not decrease
	 Train_Loss: 0.5288 Train_Acc: 74.695 Val_Loss: 0.5639  BEST VAL Loss: 0.5635  Val_Acc: 72.584

Epoch 67: Validation loss did not decrease
Early stopped at epoch : 67
LPS_0.100_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/SHSY5Y
LPS_0.100_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.70      0.89      0.78     24644
           1       0.30      0.11      0.16     10452

    accuracy                           0.66     35096
   macro avg       0.50      0.50      0.47     35096
weighted avg       0.58      0.66      0.60     35096

LPS_0.100_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/SHSY5Y
LPS_0.100_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.70      0.89      0.79      3081
           1       0.31      0.11      0.16      1307

    accuracy                           0.66      4388
   macro avg       0.51      0.50      0.48      4388
weighted avg       0.59      0.66      0.60      4388

LPS_0.100_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/SHSY5Y
LPS_0.100_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.70      0.90      0.79      3081
           1       0.29      0.10      0.15      1306

    accuracy                           0.66      4387
   macro avg       0.50      0.50      0.47      4387
weighted avg       0.58      0.66      0.60      4387

              precision    recall  f1-score   support

           0       0.70      0.90      0.79      3081
           1       0.29      0.10      0.15      1306

    accuracy                           0.66      4387
   macro avg       0.50      0.50      0.47      4387
weighted avg       0.58      0.66      0.60      4387

LPS_0.100_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/SHSY5Y
LPS_0.100_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.52      0.89      0.66      4837
           1       0.50      0.12      0.19      4445

    accuracy                           0.52      9282
   macro avg       0.51      0.50      0.43      9282
weighted avg       0.51      0.52      0.44      9282

              precision    recall  f1-score   support

           0       0.52      0.89      0.66      4837
           1       0.50      0.12      0.19      4445

    accuracy                           0.52      9282
   macro avg       0.51      0.50      0.43      9282
weighted avg       0.51      0.52      0.44      9282

completed
