[NbConvertApp] WARNING | Config option `kernel_spec_manager_class` not recognized by `NbConvertApp`.
[NbConvertApp] Converting notebook ../notebooks/Hyperparameter_Optimization_model_multi-class.ipynb to script
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3e2c848c' detected. Corrected to 'fcf5f98e'.
  validate(nb)
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3c53f7e4' detected. Corrected to '23fdbac3'.
  validate(nb)
[NbConvertApp] Writing 14456 bytes to Hyperparameter_Optimization_model_multi-class.py
[NbConvertApp] Converting notebook ../notebooks/Hyperparameter_Optimization_model_regression.ipynb to script
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3e2c848c' detected. Corrected to '1bd2755e'.
  validate(nb)
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3c53f7e4' detected. Corrected to 'f9e6857d'.
  validate(nb)
[NbConvertApp] Writing 12852 bytes to Hyperparameter_Optimization_model_regression.py
[NbConvertApp] Converting notebook ../notebooks/train_binary_model.ipynb to script
[NbConvertApp] Writing 19547 bytes to train_binary_model.py
cell_type: SHSY5Y control_name: LPS_0.100_DMSO_0.025 treatment_name: LPS_10.000_DMSO_0.025 shuffle: True
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:997: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y1], palette="blue", label="Train")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:998: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y2], palette="orange", label="Validation")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:997: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y1], palette="blue", label="Train")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:998: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y2], palette="orange", label="Validation")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1018: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1324: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1324: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
CELL_TYPE: SHSY5Y
CONTROL_NAME: LPS_0.100_DMSO_0.025
TREATMENT_NAME: LPS_10.000_DMSO_0.025
SHUFFLE: True
True
Selected Catagories are:
['LPS_0.100_DMSO_0.025' 'LPS_10.000_DMSO_0.025']
The dimensions of the data are: (34320, 1276)
Number of total missing values across all columns: 68640
Data Subset Is Off
Wells held out for testing: ['C20' 'E21']
Wells to use for training, validation, and testing ['C16' 'E16' 'C17' 'E17' 'E20' 'C21']
Number of in features:  1251
Number of out features:  2
Binary_Classification
Adam
Epoch 0: Validation loss decreased (inf --> 0.679907).  Saving model ...
	 Train_Loss: 0.7298 Train_Acc: 52.575 Val_Loss: 0.6799  BEST VAL Loss: 0.6799  Val_Acc: 56.904

Epoch 1: Validation loss decreased (0.679907 --> 0.673119).  Saving model ...
	 Train_Loss: 0.7057 Train_Acc: 56.912 Val_Loss: 0.6731  BEST VAL Loss: 0.6731  Val_Acc: 59.860

Epoch 2: Validation loss decreased (0.673119 --> 0.665788).  Saving model ...
	 Train_Loss: 0.6929 Train_Acc: 59.723 Val_Loss: 0.6658  BEST VAL Loss: 0.6658  Val_Acc: 62.660

Epoch 3: Validation loss decreased (0.665788 --> 0.660969).  Saving model ...
	 Train_Loss: 0.6827 Train_Acc: 61.901 Val_Loss: 0.6610  BEST VAL Loss: 0.6610  Val_Acc: 62.271

Epoch 4: Validation loss decreased (0.660969 --> 0.656737).  Saving model ...
	 Train_Loss: 0.6745 Train_Acc: 63.234 Val_Loss: 0.6567  BEST VAL Loss: 0.6567  Val_Acc: 63.205

Epoch 5: Validation loss decreased (0.656737 --> 0.654706).  Saving model ...
	 Train_Loss: 0.6682 Train_Acc: 64.206 Val_Loss: 0.6547  BEST VAL Loss: 0.6547  Val_Acc: 63.166

Epoch 6: Validation loss decreased (0.654706 --> 0.652749).  Saving model ...
	 Train_Loss: 0.6626 Train_Acc: 64.882 Val_Loss: 0.6527  BEST VAL Loss: 0.6527  Val_Acc: 63.633

Epoch 7: Validation loss decreased (0.652749 --> 0.651057).  Saving model ...
	 Train_Loss: 0.6584 Train_Acc: 65.154 Val_Loss: 0.6511  BEST VAL Loss: 0.6511  Val_Acc: 63.827

Epoch 8: Validation loss decreased (0.651057 --> 0.649951).  Saving model ...
	 Train_Loss: 0.6544 Train_Acc: 65.850 Val_Loss: 0.6500  BEST VAL Loss: 0.6500  Val_Acc: 62.816

Epoch 9: Validation loss decreased (0.649951 --> 0.649487).  Saving model ...
	 Train_Loss: 0.6507 Train_Acc: 66.545 Val_Loss: 0.6495  BEST VAL Loss: 0.6495  Val_Acc: 62.699

Epoch 10: Validation loss decreased (0.649487 --> 0.648812).  Saving model ...
	 Train_Loss: 0.6477 Train_Acc: 66.531 Val_Loss: 0.6488  BEST VAL Loss: 0.6488  Val_Acc: 63.594

Epoch 11: Validation loss decreased (0.648812 --> 0.648105).  Saving model ...
	 Train_Loss: 0.6448 Train_Acc: 66.720 Val_Loss: 0.6481  BEST VAL Loss: 0.6481  Val_Acc: 63.788

Epoch 12: Validation loss decreased (0.648105 --> 0.647697).  Saving model ...
	 Train_Loss: 0.6423 Train_Acc: 67.464 Val_Loss: 0.6477  BEST VAL Loss: 0.6477  Val_Acc: 64.138

Epoch 13: Validation loss decreased (0.647697 --> 0.647664).  Saving model ...
	 Train_Loss: 0.6398 Train_Acc: 67.493 Val_Loss: 0.6477  BEST VAL Loss: 0.6477  Val_Acc: 63.399

Epoch 14: Validation loss decreased (0.647664 --> 0.647403).  Saving model ...
	 Train_Loss: 0.6375 Train_Acc: 67.775 Val_Loss: 0.6474  BEST VAL Loss: 0.6474  Val_Acc: 63.361

Epoch 15: Validation loss did not decrease
	 Train_Loss: 0.6352 Train_Acc: 68.266 Val_Loss: 0.6475  BEST VAL Loss: 0.6474  Val_Acc: 63.438

Epoch 16: Validation loss did not decrease
	 Train_Loss: 0.6328 Train_Acc: 68.889 Val_Loss: 0.6480  BEST VAL Loss: 0.6474  Val_Acc: 63.750

Epoch 17: Validation loss did not decrease
	 Train_Loss: 0.6309 Train_Acc: 68.301 Val_Loss: 0.6479  BEST VAL Loss: 0.6474  Val_Acc: 62.972

Epoch 18: Validation loss did not decrease
	 Train_Loss: 0.6289 Train_Acc: 68.869 Val_Loss: 0.6479  BEST VAL Loss: 0.6474  Val_Acc: 62.466

Epoch 19: Validation loss did not decrease
	 Train_Loss: 0.6271 Train_Acc: 68.918 Val_Loss: 0.6492  BEST VAL Loss: 0.6474  Val_Acc: 63.672

Epoch 20: Validation loss did not decrease
	 Train_Loss: 0.6252 Train_Acc: 69.443 Val_Loss: 0.6495  BEST VAL Loss: 0.6474  Val_Acc: 64.061

Epoch 21: Validation loss did not decrease
	 Train_Loss: 0.6236 Train_Acc: 69.186 Val_Loss: 0.6500  BEST VAL Loss: 0.6474  Val_Acc: 64.061

Epoch 22: Validation loss did not decrease
	 Train_Loss: 0.6223 Train_Acc: 69.375 Val_Loss: 0.6500  BEST VAL Loss: 0.6474  Val_Acc: 63.322

Epoch 23: Validation loss did not decrease
	 Train_Loss: 0.6211 Train_Acc: 69.001 Val_Loss: 0.6500  BEST VAL Loss: 0.6474  Val_Acc: 63.399

Epoch 24: Validation loss did not decrease
	 Train_Loss: 0.6198 Train_Acc: 69.292 Val_Loss: 0.6498  BEST VAL Loss: 0.6474  Val_Acc: 63.205

Epoch 25: Validation loss did not decrease
	 Train_Loss: 0.6184 Train_Acc: 69.944 Val_Loss: 0.6503  BEST VAL Loss: 0.6474  Val_Acc: 63.011

Epoch 26: Validation loss did not decrease
	 Train_Loss: 0.6170 Train_Acc: 69.823 Val_Loss: 0.6503  BEST VAL Loss: 0.6474  Val_Acc: 63.983

Epoch 27: Validation loss did not decrease
	 Train_Loss: 0.6155 Train_Acc: 70.396 Val_Loss: 0.6503  BEST VAL Loss: 0.6474  Val_Acc: 63.594

Epoch 28: Validation loss did not decrease
	 Train_Loss: 0.6143 Train_Acc: 70.542 Val_Loss: 0.6502  BEST VAL Loss: 0.6474  Val_Acc: 63.788

Epoch 29: Validation loss did not decrease
	 Train_Loss: 0.6130 Train_Acc: 70.056 Val_Loss: 0.6508  BEST VAL Loss: 0.6474  Val_Acc: 63.244

Epoch 30: Validation loss did not decrease
Early stopped at epoch : 30
LPS_0.100_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/SHSY5Y
LPS_0.100_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.52      0.41      0.46     10451
           1       0.50      0.60      0.55     10114

    accuracy                           0.50     20565
   macro avg       0.51      0.51      0.50     20565
weighted avg       0.51      0.50      0.50     20565

LPS_0.100_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/SHSY5Y
LPS_0.100_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.52      0.41      0.46      1307
           1       0.50      0.60      0.54      1264

    accuracy                           0.51      2571
   macro avg       0.51      0.51      0.50      2571
weighted avg       0.51      0.51      0.50      2571

LPS_0.100_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/SHSY5Y
LPS_0.100_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.51      0.41      0.45      1307
           1       0.50      0.60      0.54      1264

    accuracy                           0.50      2571
   macro avg       0.50      0.50      0.50      2571
weighted avg       0.50      0.50      0.50      2571

              precision    recall  f1-score   support

           0       0.51      0.41      0.45      1307
           1       0.50      0.60      0.54      1264

    accuracy                           0.50      2571
   macro avg       0.50      0.50      0.50      2571
weighted avg       0.50      0.50      0.50      2571

LPS_0.100_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/SHSY5Y
LPS_0.100_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.51      0.47      0.49      4445
           1       0.48      0.52      0.50      4168

    accuracy                           0.49      8613
   macro avg       0.50      0.50      0.49      8613
weighted avg       0.50      0.49      0.49      8613

              precision    recall  f1-score   support

           0       0.51      0.47      0.49      4445
           1       0.48      0.52      0.50      4168

    accuracy                           0.49      8613
   macro avg       0.50      0.50      0.49      8613
weighted avg       0.50      0.49      0.49      8613

completed
