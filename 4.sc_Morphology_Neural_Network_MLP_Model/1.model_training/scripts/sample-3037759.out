[NbConvertApp] WARNING | Config option `kernel_spec_manager_class` not recognized by `NbConvertApp`.
[NbConvertApp] Converting notebook ../notebooks/Hyperparameter_Optimization_model_multi-class.ipynb to script
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3e2c848c' detected. Corrected to '078929d6'.
  validate(nb)
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3c53f7e4' detected. Corrected to 'e4b0d149'.
  validate(nb)
[NbConvertApp] Writing 14456 bytes to Hyperparameter_Optimization_model_multi-class.py
[NbConvertApp] Converting notebook ../notebooks/Hyperparameter_Optimization_model_regression.ipynb to script
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3e2c848c' detected. Corrected to 'b2272eab'.
  validate(nb)
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3c53f7e4' detected. Corrected to 'd915b4bb'.
  validate(nb)
[NbConvertApp] Writing 12852 bytes to Hyperparameter_Optimization_model_regression.py
[NbConvertApp] Converting notebook ../notebooks/train_binary_model.ipynb to script
[NbConvertApp] Writing 19547 bytes to train_binary_model.py
cell_type: SHSY5Y control_name: LPS_1.000_DMSO_0.025 treatment_name: DMSO_0.100_DMSO_0.025 shuffle: True
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:997: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y1], palette="blue", label="Train")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:998: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y2], palette="orange", label="Validation")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:997: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y1], palette="blue", label="Train")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:998: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y2], palette="orange", label="Validation")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1018: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1324: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1324: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
CELL_TYPE: SHSY5Y
CONTROL_NAME: LPS_1.000_DMSO_0.025
TREATMENT_NAME: DMSO_0.100_DMSO_0.025
SHUFFLE: True
True
Selected Catagories are:
['DMSO_0.100_DMSO_0.025' 'LPS_1.000_DMSO_0.025']
The dimensions of the data are: (52101, 1276)
Number of total missing values across all columns: 104202
Data Subset Is Off
Wells held out for testing: ['D20' 'I14']
Wells to use for training, validation, and testing ['B14' 'C14' 'B15' 'C15' 'D16' 'D17' 'D21' 'J14' 'I15' 'J15']
Number of in features:  1251
Number of out features:  2
Binary_Classification
Adam
Epoch 0: Validation loss decreased (inf --> 0.534818).  Saving model ...
	 Train_Loss: 0.6157 Train_Acc: 68.094 Val_Loss: 0.5348  BEST VAL Loss: 0.5348  Val_Acc: 73.852

Epoch 1: Validation loss decreased (0.534818 --> 0.522553).  Saving model ...
	 Train_Loss: 0.5657 Train_Acc: 75.247 Val_Loss: 0.5226  BEST VAL Loss: 0.5226  Val_Acc: 75.197

Epoch 2: Validation loss decreased (0.522553 --> 0.515781).  Saving model ...
	 Train_Loss: 0.5417 Train_Acc: 76.482 Val_Loss: 0.5158  BEST VAL Loss: 0.5158  Val_Acc: 76.102

Epoch 3: Validation loss decreased (0.515781 --> 0.511402).  Saving model ...
	 Train_Loss: 0.5265 Train_Acc: 77.283 Val_Loss: 0.5114  BEST VAL Loss: 0.5114  Val_Acc: 75.313

Epoch 4: Validation loss decreased (0.511402 --> 0.508741).  Saving model ...
	 Train_Loss: 0.5152 Train_Acc: 77.515 Val_Loss: 0.5087  BEST VAL Loss: 0.5087  Val_Acc: 76.172

Epoch 5: Validation loss decreased (0.508741 --> 0.505072).  Saving model ...
	 Train_Loss: 0.5066 Train_Acc: 78.089 Val_Loss: 0.5051  BEST VAL Loss: 0.5051  Val_Acc: 76.752

Epoch 6: Validation loss decreased (0.505072 --> 0.501125).  Saving model ...
	 Train_Loss: 0.4995 Train_Acc: 78.257 Val_Loss: 0.5011  BEST VAL Loss: 0.5011  Val_Acc: 76.450

Epoch 7: Validation loss decreased (0.501125 --> 0.499635).  Saving model ...
	 Train_Loss: 0.4932 Train_Acc: 78.774 Val_Loss: 0.4996  BEST VAL Loss: 0.4996  Val_Acc: 76.450

Epoch 8: Validation loss decreased (0.499635 --> 0.497880).  Saving model ...
	 Train_Loss: 0.4881 Train_Acc: 78.878 Val_Loss: 0.4979  BEST VAL Loss: 0.4979  Val_Acc: 76.752

Epoch 9: Validation loss decreased (0.497880 --> 0.497134).  Saving model ...
	 Train_Loss: 0.4830 Train_Acc: 79.519 Val_Loss: 0.4971  BEST VAL Loss: 0.4971  Val_Acc: 77.494

Epoch 10: Validation loss decreased (0.497134 --> 0.495089).  Saving model ...
	 Train_Loss: 0.4786 Train_Acc: 79.771 Val_Loss: 0.4951  BEST VAL Loss: 0.4951  Val_Acc: 77.262

Epoch 11: Validation loss decreased (0.495089 --> 0.494330).  Saving model ...
	 Train_Loss: 0.4744 Train_Acc: 79.966 Val_Loss: 0.4943  BEST VAL Loss: 0.4943  Val_Acc: 77.285

Epoch 12: Validation loss decreased (0.494330 --> 0.493817).  Saving model ...
	 Train_Loss: 0.4704 Train_Acc: 80.227 Val_Loss: 0.4938  BEST VAL Loss: 0.4938  Val_Acc: 76.682

Epoch 13: Validation loss decreased (0.493817 --> 0.492542).  Saving model ...
	 Train_Loss: 0.4669 Train_Acc: 80.317 Val_Loss: 0.4925  BEST VAL Loss: 0.4925  Val_Acc: 77.564

Epoch 14: Validation loss decreased (0.492542 --> 0.491571).  Saving model ...
	 Train_Loss: 0.4636 Train_Acc: 80.401 Val_Loss: 0.4916  BEST VAL Loss: 0.4916  Val_Acc: 76.775

Epoch 15: Validation loss decreased (0.491571 --> 0.490997).  Saving model ...
	 Train_Loss: 0.4604 Train_Acc: 80.842 Val_Loss: 0.4910  BEST VAL Loss: 0.4910  Val_Acc: 77.471

Epoch 16: Validation loss decreased (0.490997 --> 0.490128).  Saving model ...
	 Train_Loss: 0.4573 Train_Acc: 80.761 Val_Loss: 0.4901  BEST VAL Loss: 0.4901  Val_Acc: 77.378

Epoch 17: Validation loss decreased (0.490128 --> 0.488694).  Saving model ...
	 Train_Loss: 0.4544 Train_Acc: 81.210 Val_Loss: 0.4887  BEST VAL Loss: 0.4887  Val_Acc: 76.961

Epoch 18: Validation loss decreased (0.488694 --> 0.487870).  Saving model ...
	 Train_Loss: 0.4516 Train_Acc: 81.410 Val_Loss: 0.4879  BEST VAL Loss: 0.4879  Val_Acc: 77.587

Epoch 19: Validation loss did not decrease
	 Train_Loss: 0.4489 Train_Acc: 81.486 Val_Loss: 0.4882  BEST VAL Loss: 0.4879  Val_Acc: 77.425

Epoch 20: Validation loss decreased (0.487870 --> 0.487557).  Saving model ...
	 Train_Loss: 0.4464 Train_Acc: 81.755 Val_Loss: 0.4876  BEST VAL Loss: 0.4876  Val_Acc: 77.703

Epoch 21: Validation loss decreased (0.487557 --> 0.487231).  Saving model ...
	 Train_Loss: 0.4440 Train_Acc: 81.602 Val_Loss: 0.4872  BEST VAL Loss: 0.4872  Val_Acc: 77.332

Epoch 22: Validation loss decreased (0.487231 --> 0.486401).  Saving model ...
	 Train_Loss: 0.4416 Train_Acc: 81.811 Val_Loss: 0.4864  BEST VAL Loss: 0.4864  Val_Acc: 77.749

Epoch 23: Validation loss decreased (0.486401 --> 0.486060).  Saving model ...
	 Train_Loss: 0.4392 Train_Acc: 82.269 Val_Loss: 0.4861  BEST VAL Loss: 0.4861  Val_Acc: 77.935

Epoch 24: Validation loss did not decrease
	 Train_Loss: 0.4370 Train_Acc: 82.014 Val_Loss: 0.4868  BEST VAL Loss: 0.4861  Val_Acc: 77.169

Epoch 25: Validation loss did not decrease
	 Train_Loss: 0.4349 Train_Acc: 82.072 Val_Loss: 0.4867  BEST VAL Loss: 0.4861  Val_Acc: 77.564

Epoch 26: Validation loss did not decrease
	 Train_Loss: 0.4329 Train_Acc: 82.338 Val_Loss: 0.4869  BEST VAL Loss: 0.4861  Val_Acc: 77.378

Epoch 27: Validation loss did not decrease
	 Train_Loss: 0.4309 Train_Acc: 82.504 Val_Loss: 0.4867  BEST VAL Loss: 0.4861  Val_Acc: 77.564

Epoch 28: Validation loss did not decrease
	 Train_Loss: 0.4289 Train_Acc: 82.614 Val_Loss: 0.4865  BEST VAL Loss: 0.4861  Val_Acc: 77.494

Epoch 29: Validation loss did not decrease
	 Train_Loss: 0.4271 Train_Acc: 82.594 Val_Loss: 0.4863  BEST VAL Loss: 0.4861  Val_Acc: 77.100

Epoch 30: Validation loss did not decrease
	 Train_Loss: 0.4253 Train_Acc: 82.855 Val_Loss: 0.4862  BEST VAL Loss: 0.4861  Val_Acc: 77.726

Epoch 31: Validation loss did not decrease
	 Train_Loss: 0.4234 Train_Acc: 83.072 Val_Loss: 0.4864  BEST VAL Loss: 0.4861  Val_Acc: 77.657

Epoch 32: Validation loss did not decrease
	 Train_Loss: 0.4217 Train_Acc: 83.136 Val_Loss: 0.4872  BEST VAL Loss: 0.4861  Val_Acc: 78.144

Epoch 33: Validation loss did not decrease
	 Train_Loss: 0.4199 Train_Acc: 83.249 Val_Loss: 0.4874  BEST VAL Loss: 0.4861  Val_Acc: 77.146

Epoch 34: Validation loss did not decrease
	 Train_Loss: 0.4181 Train_Acc: 83.531 Val_Loss: 0.4878  BEST VAL Loss: 0.4861  Val_Acc: 78.097

Epoch 35: Validation loss did not decrease
	 Train_Loss: 0.4165 Train_Acc: 83.380 Val_Loss: 0.4880  BEST VAL Loss: 0.4861  Val_Acc: 78.097

Epoch 36: Validation loss did not decrease
	 Train_Loss: 0.4149 Train_Acc: 83.241 Val_Loss: 0.4878  BEST VAL Loss: 0.4861  Val_Acc: 78.167

Epoch 37: Validation loss did not decrease
	 Train_Loss: 0.4134 Train_Acc: 83.536 Val_Loss: 0.4888  BEST VAL Loss: 0.4861  Val_Acc: 78.376

Epoch 38: Validation loss did not decrease
	 Train_Loss: 0.4118 Train_Acc: 83.615 Val_Loss: 0.4890  BEST VAL Loss: 0.4861  Val_Acc: 77.587

Epoch 39: Validation loss did not decrease
Early stopped at epoch : 39
LPS_1.000_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/SHSY5Y
LPS_1.000_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.72      0.78      0.75     24644
           1       0.29      0.23      0.26      9832

    accuracy                           0.62     34476
   macro avg       0.50      0.50      0.50     34476
weighted avg       0.59      0.62      0.61     34476

LPS_1.000_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/SHSY5Y
LPS_1.000_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.71      0.79      0.75      3081
           1       0.28      0.21      0.24      1229

    accuracy                           0.62      4310
   macro avg       0.50      0.50      0.49      4310
weighted avg       0.59      0.62      0.60      4310

LPS_1.000_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/SHSY5Y
LPS_1.000_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.71      0.79      0.75      3081
           1       0.29      0.21      0.24      1229

    accuracy                           0.62      4310
   macro avg       0.50      0.50      0.50      4310
weighted avg       0.59      0.62      0.61      4310

              precision    recall  f1-score   support

           0       0.71      0.79      0.75      3081
           1       0.29      0.21      0.24      1229

    accuracy                           0.62      4310
   macro avg       0.50      0.50      0.50      4310
weighted avg       0.59      0.62      0.61      4310

LPS_1.000_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/SHSY5Y
LPS_1.000_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.54      0.66      0.59      4837
           1       0.46      0.34      0.39      4168

    accuracy                           0.51      9005
   macro avg       0.50      0.50      0.49      9005
weighted avg       0.50      0.51      0.50      9005

              precision    recall  f1-score   support

           0       0.54      0.66      0.59      4837
           1       0.46      0.34      0.39      4168

    accuracy                           0.51      9005
   macro avg       0.50      0.50      0.49      9005
weighted avg       0.50      0.51      0.50      9005

completed
