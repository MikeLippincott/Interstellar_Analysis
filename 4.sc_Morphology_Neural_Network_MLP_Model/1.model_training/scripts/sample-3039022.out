[NbConvertApp] WARNING | Config option `kernel_spec_manager_class` not recognized by `NbConvertApp`.
[NbConvertApp] Converting notebook ../notebooks/Hyperparameter_Optimization_model_multi-class.ipynb to script
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3e2c848c' detected. Corrected to '0005f1a0'.
  validate(nb)
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3c53f7e4' detected. Corrected to 'f51c0f23'.
  validate(nb)
[NbConvertApp] Writing 14456 bytes to Hyperparameter_Optimization_model_multi-class.py
[NbConvertApp] Converting notebook ../notebooks/Hyperparameter_Optimization_model_regression.ipynb to script
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3e2c848c' detected. Corrected to 'eaf63bcf'.
  validate(nb)
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3c53f7e4' detected. Corrected to 'cc872226'.
  validate(nb)
[NbConvertApp] Writing 12852 bytes to Hyperparameter_Optimization_model_regression.py
[NbConvertApp] Converting notebook ../notebooks/train_binary_model.ipynb to script
[NbConvertApp] Writing 19547 bytes to train_binary_model.py
cell_type: SHSY5Y control_name: LPS_0.010_DMSO_0.025 treatment_name: LPS_1.000_DMSO_0.025 shuffle: True
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:997: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y1], palette="blue", label="Train")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:998: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y2], palette="orange", label="Validation")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:997: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y1], palette="blue", label="Train")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:998: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y2], palette="orange", label="Validation")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1018: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1324: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1324: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
CELL_TYPE: SHSY5Y
CONTROL_NAME: LPS_0.010_DMSO_0.025
TREATMENT_NAME: LPS_1.000_DMSO_0.025
SHUFFLE: True
True
Selected Catagories are:
['LPS_0.010_DMSO_0.025' 'LPS_1.000_DMSO_0.025']
The dimensions of the data are: (32317, 1276)
Number of total missing values across all columns: 64634
Data Subset Is Off
Wells held out for testing: ['B20' 'D21']
Wells to use for training, validation, and testing ['B16' 'D16' 'B17' 'D17' 'D20' 'B21']
Number of in features:  1251
Number of out features:  2
Binary_Classification
Adam
Epoch 0: Validation loss decreased (inf --> 0.626738).  Saving model ...
	 Train_Loss: 0.6918 Train_Acc: 58.730 Val_Loss: 0.6267  BEST VAL Loss: 0.6267  Val_Acc: 65.221

Epoch 1: Validation loss decreased (0.626738 --> 0.607328).  Saving model ...
	 Train_Loss: 0.6534 Train_Acc: 65.971 Val_Loss: 0.6073  BEST VAL Loss: 0.6073  Val_Acc: 68.869

Epoch 2: Validation loss decreased (0.607328 --> 0.595673).  Saving model ...
	 Train_Loss: 0.6301 Train_Acc: 68.894 Val_Loss: 0.5957  BEST VAL Loss: 0.5957  Val_Acc: 70.531

Epoch 3: Validation loss decreased (0.595673 --> 0.586965).  Saving model ...
	 Train_Loss: 0.6135 Train_Acc: 70.440 Val_Loss: 0.5870  BEST VAL Loss: 0.5870  Val_Acc: 71.544

Epoch 4: Validation loss decreased (0.586965 --> 0.579108).  Saving model ...
	 Train_Loss: 0.6012 Train_Acc: 71.043 Val_Loss: 0.5791  BEST VAL Loss: 0.5791  Val_Acc: 72.031

Epoch 5: Validation loss decreased (0.579108 --> 0.573330).  Saving model ...
	 Train_Loss: 0.5912 Train_Acc: 72.558 Val_Loss: 0.5733  BEST VAL Loss: 0.5733  Val_Acc: 72.639

Epoch 6: Validation loss decreased (0.573330 --> 0.569127).  Saving model ...
	 Train_Loss: 0.5826 Train_Acc: 73.328 Val_Loss: 0.5691  BEST VAL Loss: 0.5691  Val_Acc: 72.396

Epoch 7: Validation loss decreased (0.569127 --> 0.564283).  Saving model ...
	 Train_Loss: 0.5748 Train_Acc: 73.759 Val_Loss: 0.5643  BEST VAL Loss: 0.5643  Val_Acc: 72.598

Epoch 8: Validation loss decreased (0.564283 --> 0.561044).  Saving model ...
	 Train_Loss: 0.5679 Train_Acc: 74.204 Val_Loss: 0.5610  BEST VAL Loss: 0.5610  Val_Acc: 73.247

Epoch 9: Validation loss decreased (0.561044 --> 0.556948).  Saving model ...
	 Train_Loss: 0.5617 Train_Acc: 74.417 Val_Loss: 0.5569  BEST VAL Loss: 0.5569  Val_Acc: 73.814

Epoch 10: Validation loss decreased (0.556948 --> 0.553685).  Saving model ...
	 Train_Loss: 0.5561 Train_Acc: 75.208 Val_Loss: 0.5537  BEST VAL Loss: 0.5537  Val_Acc: 73.571

Epoch 11: Validation loss decreased (0.553685 --> 0.551865).  Saving model ...
	 Train_Loss: 0.5511 Train_Acc: 75.365 Val_Loss: 0.5519  BEST VAL Loss: 0.5519  Val_Acc: 73.733

Epoch 12: Validation loss decreased (0.551865 --> 0.549965).  Saving model ...
	 Train_Loss: 0.5466 Train_Acc: 75.562 Val_Loss: 0.5500  BEST VAL Loss: 0.5500  Val_Acc: 73.004

Epoch 13: Validation loss decreased (0.549965 --> 0.548445).  Saving model ...
	 Train_Loss: 0.5421 Train_Acc: 76.439 Val_Loss: 0.5484  BEST VAL Loss: 0.5484  Val_Acc: 74.098

Epoch 14: Validation loss decreased (0.548445 --> 0.546280).  Saving model ...
	 Train_Loss: 0.5381 Train_Acc: 76.480 Val_Loss: 0.5463  BEST VAL Loss: 0.5463  Val_Acc: 73.571

Epoch 15: Validation loss decreased (0.546280 --> 0.544765).  Saving model ...
	 Train_Loss: 0.5344 Train_Acc: 76.454 Val_Loss: 0.5448  BEST VAL Loss: 0.5448  Val_Acc: 75.193

Epoch 16: Validation loss decreased (0.544765 --> 0.543213).  Saving model ...
	 Train_Loss: 0.5310 Train_Acc: 76.875 Val_Loss: 0.5432  BEST VAL Loss: 0.5432  Val_Acc: 74.098

Epoch 17: Validation loss decreased (0.543213 --> 0.541885).  Saving model ...
	 Train_Loss: 0.5278 Train_Acc: 77.093 Val_Loss: 0.5419  BEST VAL Loss: 0.5419  Val_Acc: 73.612

Epoch 18: Validation loss decreased (0.541885 --> 0.540471).  Saving model ...
	 Train_Loss: 0.5245 Train_Acc: 77.387 Val_Loss: 0.5405  BEST VAL Loss: 0.5405  Val_Acc: 74.625

Epoch 19: Validation loss decreased (0.540471 --> 0.539027).  Saving model ...
	 Train_Loss: 0.5213 Train_Acc: 78.096 Val_Loss: 0.5390  BEST VAL Loss: 0.5390  Val_Acc: 75.314

Epoch 20: Validation loss decreased (0.539027 --> 0.537955).  Saving model ...
	 Train_Loss: 0.5182 Train_Acc: 77.919 Val_Loss: 0.5380  BEST VAL Loss: 0.5380  Val_Acc: 74.949

Epoch 21: Validation loss decreased (0.537955 --> 0.536564).  Saving model ...
	 Train_Loss: 0.5155 Train_Acc: 77.843 Val_Loss: 0.5366  BEST VAL Loss: 0.5366  Val_Acc: 75.274

Epoch 22: Validation loss decreased (0.536564 --> 0.535768).  Saving model ...
	 Train_Loss: 0.5125 Train_Acc: 78.663 Val_Loss: 0.5358  BEST VAL Loss: 0.5358  Val_Acc: 74.828

Epoch 23: Validation loss decreased (0.535768 --> 0.534846).  Saving model ...
	 Train_Loss: 0.5098 Train_Acc: 78.825 Val_Loss: 0.5348  BEST VAL Loss: 0.5348  Val_Acc: 75.436

Epoch 24: Validation loss decreased (0.534846 --> 0.533886).  Saving model ...
	 Train_Loss: 0.5070 Train_Acc: 78.927 Val_Loss: 0.5339  BEST VAL Loss: 0.5339  Val_Acc: 75.719

Epoch 25: Validation loss decreased (0.533886 --> 0.533777).  Saving model ...
	 Train_Loss: 0.5043 Train_Acc: 79.059 Val_Loss: 0.5338  BEST VAL Loss: 0.5338  Val_Acc: 75.355

Epoch 26: Validation loss decreased (0.533777 --> 0.533304).  Saving model ...
	 Train_Loss: 0.5017 Train_Acc: 79.327 Val_Loss: 0.5333  BEST VAL Loss: 0.5333  Val_Acc: 75.152

Epoch 27: Validation loss decreased (0.533304 --> 0.532982).  Saving model ...
	 Train_Loss: 0.4995 Train_Acc: 78.957 Val_Loss: 0.5330  BEST VAL Loss: 0.5330  Val_Acc: 75.193

Epoch 28: Validation loss decreased (0.532982 --> 0.532542).  Saving model ...
	 Train_Loss: 0.4971 Train_Acc: 79.444 Val_Loss: 0.5325  BEST VAL Loss: 0.5325  Val_Acc: 75.638

Epoch 29: Validation loss decreased (0.532542 --> 0.532044).  Saving model ...
	 Train_Loss: 0.4948 Train_Acc: 79.540 Val_Loss: 0.5320  BEST VAL Loss: 0.5320  Val_Acc: 76.084

Epoch 30: Validation loss decreased (0.532044 --> 0.532028).  Saving model ...
	 Train_Loss: 0.4925 Train_Acc: 79.778 Val_Loss: 0.5320  BEST VAL Loss: 0.5320  Val_Acc: 75.557

Epoch 31: Validation loss decreased (0.532028 --> 0.531429).  Saving model ...
	 Train_Loss: 0.4902 Train_Acc: 79.814 Val_Loss: 0.5314  BEST VAL Loss: 0.5314  Val_Acc: 76.165

Epoch 32: Validation loss decreased (0.531429 --> 0.530876).  Saving model ...
	 Train_Loss: 0.4881 Train_Acc: 80.067 Val_Loss: 0.5309  BEST VAL Loss: 0.5309  Val_Acc: 75.436

Epoch 33: Validation loss decreased (0.530876 --> 0.530564).  Saving model ...
	 Train_Loss: 0.4862 Train_Acc: 80.183 Val_Loss: 0.5306  BEST VAL Loss: 0.5306  Val_Acc: 75.274

Epoch 34: Validation loss decreased (0.530564 --> 0.530069).  Saving model ...
	 Train_Loss: 0.4843 Train_Acc: 80.133 Val_Loss: 0.5301  BEST VAL Loss: 0.5301  Val_Acc: 75.314

Epoch 35: Validation loss decreased (0.530069 --> 0.529894).  Saving model ...
	 Train_Loss: 0.4822 Train_Acc: 80.700 Val_Loss: 0.5299  BEST VAL Loss: 0.5299  Val_Acc: 75.598

Epoch 36: Validation loss decreased (0.529894 --> 0.529597).  Saving model ...
	 Train_Loss: 0.4803 Train_Acc: 80.665 Val_Loss: 0.5296  BEST VAL Loss: 0.5296  Val_Acc: 75.719

Epoch 37: Validation loss decreased (0.529597 --> 0.529555).  Saving model ...
	 Train_Loss: 0.4783 Train_Acc: 81.025 Val_Loss: 0.5296  BEST VAL Loss: 0.5296  Val_Acc: 75.922

Epoch 38: Validation loss did not decrease
	 Train_Loss: 0.4764 Train_Acc: 80.741 Val_Loss: 0.5297  BEST VAL Loss: 0.5296  Val_Acc: 75.598

Epoch 39: Validation loss did not decrease
	 Train_Loss: 0.4746 Train_Acc: 80.999 Val_Loss: 0.5299  BEST VAL Loss: 0.5296  Val_Acc: 75.598

Epoch 40: Validation loss did not decrease
	 Train_Loss: 0.4728 Train_Acc: 80.791 Val_Loss: 0.5298  BEST VAL Loss: 0.5296  Val_Acc: 75.638

Epoch 41: Validation loss did not decrease
	 Train_Loss: 0.4710 Train_Acc: 81.263 Val_Loss: 0.5303  BEST VAL Loss: 0.5296  Val_Acc: 74.949

Epoch 42: Validation loss did not decrease
	 Train_Loss: 0.4693 Train_Acc: 80.989 Val_Loss: 0.5304  BEST VAL Loss: 0.5296  Val_Acc: 75.638

Epoch 43: Validation loss did not decrease
	 Train_Loss: 0.4678 Train_Acc: 81.014 Val_Loss: 0.5299  BEST VAL Loss: 0.5296  Val_Acc: 75.152

Epoch 44: Validation loss did not decrease
	 Train_Loss: 0.4661 Train_Acc: 81.450 Val_Loss: 0.5302  BEST VAL Loss: 0.5296  Val_Acc: 75.557

Epoch 45: Validation loss did not decrease
	 Train_Loss: 0.4645 Train_Acc: 81.384 Val_Loss: 0.5303  BEST VAL Loss: 0.5296  Val_Acc: 75.598

Epoch 46: Validation loss did not decrease
	 Train_Loss: 0.4629 Train_Acc: 82.033 Val_Loss: 0.5306  BEST VAL Loss: 0.5296  Val_Acc: 74.544

Epoch 47: Validation loss did not decrease
	 Train_Loss: 0.4613 Train_Acc: 81.638 Val_Loss: 0.5312  BEST VAL Loss: 0.5296  Val_Acc: 75.638

Epoch 48: Validation loss did not decrease
	 Train_Loss: 0.4598 Train_Acc: 81.790 Val_Loss: 0.5312  BEST VAL Loss: 0.5296  Val_Acc: 75.233

Epoch 49: Validation loss did not decrease
	 Train_Loss: 0.4583 Train_Acc: 81.617 Val_Loss: 0.5315  BEST VAL Loss: 0.5296  Val_Acc: 74.706

Epoch 50: Validation loss did not decrease
	 Train_Loss: 0.4568 Train_Acc: 81.779 Val_Loss: 0.5316  BEST VAL Loss: 0.5296  Val_Acc: 75.436

Epoch 51: Validation loss did not decrease
	 Train_Loss: 0.4553 Train_Acc: 82.084 Val_Loss: 0.5321  BEST VAL Loss: 0.5296  Val_Acc: 75.719

Epoch 52: Validation loss did not decrease
	 Train_Loss: 0.4539 Train_Acc: 81.790 Val_Loss: 0.5325  BEST VAL Loss: 0.5296  Val_Acc: 74.463

Epoch 53: Validation loss did not decrease
Early stopped at epoch : 53
LPS_0.010_DMSO_0.025_vs_LPS_1.000_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/SHSY5Y
LPS_0.010_DMSO_0.025_vs_LPS_1.000_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.49      0.46      0.48      9708
           1       0.51      0.53      0.52     10028

    accuracy                           0.50     19736
   macro avg       0.50      0.50      0.50     19736
weighted avg       0.50      0.50      0.50     19736

LPS_0.010_DMSO_0.025_vs_LPS_1.000_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/SHSY5Y
LPS_0.010_DMSO_0.025_vs_LPS_1.000_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.48      0.45      0.47      1213
           1       0.50      0.53      0.52      1254

    accuracy                           0.49      2467
   macro avg       0.49      0.49      0.49      2467
weighted avg       0.49      0.49      0.49      2467

LPS_0.010_DMSO_0.025_vs_LPS_1.000_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/SHSY5Y
LPS_0.010_DMSO_0.025_vs_LPS_1.000_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.50      0.47      0.49      1214
           1       0.52      0.55      0.54      1253

    accuracy                           0.51      2467
   macro avg       0.51      0.51      0.51      2467
weighted avg       0.51      0.51      0.51      2467

              precision    recall  f1-score   support

           0       0.50      0.47      0.49      1214
           1       0.52      0.55      0.54      1253

    accuracy                           0.51      2467
   macro avg       0.51      0.51      0.51      2467
weighted avg       0.51      0.51      0.51      2467

LPS_0.010_DMSO_0.025_vs_LPS_1.000_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/SHSY5Y
LPS_0.010_DMSO_0.025_vs_LPS_1.000_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.49      0.59      0.53      3724
           1       0.51      0.41      0.45      3923

    accuracy                           0.50      7647
   macro avg       0.50      0.50      0.49      7647
weighted avg       0.50      0.50      0.49      7647

              precision    recall  f1-score   support

           0       0.49      0.59      0.53      3724
           1       0.51      0.41      0.45      3923

    accuracy                           0.50      7647
   macro avg       0.50      0.50      0.49      7647
weighted avg       0.50      0.50      0.49      7647

completed
