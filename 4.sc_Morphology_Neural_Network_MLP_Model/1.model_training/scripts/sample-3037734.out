[NbConvertApp] WARNING | Config option `kernel_spec_manager_class` not recognized by `NbConvertApp`.
[NbConvertApp] Converting notebook ../notebooks/Hyperparameter_Optimization_model_multi-class.ipynb to script
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3e2c848c' detected. Corrected to '36c5190d'.
  validate(nb)
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3c53f7e4' detected. Corrected to '8dc354f5'.
  validate(nb)
[NbConvertApp] Writing 14456 bytes to Hyperparameter_Optimization_model_multi-class.py
[NbConvertApp] Converting notebook ../notebooks/Hyperparameter_Optimization_model_regression.ipynb to script
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3e2c848c' detected. Corrected to 'efc2c314'.
  validate(nb)
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3c53f7e4' detected. Corrected to '0be2fcbc'.
  validate(nb)
[NbConvertApp] Writing 12852 bytes to Hyperparameter_Optimization_model_regression.py
[NbConvertApp] Converting notebook ../notebooks/train_binary_model.ipynb to script
[NbConvertApp] Writing 19547 bytes to train_binary_model.py
cell_type: PBMC control_name: Flagellin_1.000_DMSO_0.025 treatment_name: DMSO_0.100_DMSO_0.025 shuffle: True
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:997: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y1], palette="blue", label="Train")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:998: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y2], palette="orange", label="Validation")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:997: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y1], palette="blue", label="Train")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:998: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y2], palette="orange", label="Validation")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1018: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1324: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1324: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
CELL_TYPE: PBMC
CONTROL_NAME: Flagellin_1.000_DMSO_0.025
TREATMENT_NAME: DMSO_0.100_DMSO_0.025
SHUFFLE: True
True
Selected Catagories are:
['DMSO_0.100_DMSO_0.025' 'Flagellin_1.000_DMSO_0.025']
The dimensions of the data are: (319677, 1270)
Number of total missing values across all columns: 675970
Data Subset Is Off
Wells held out for testing: ['J06' 'M10']
Wells to use for training, validation, and testing ['B06' 'C06' 'B07' 'C07' 'I06' 'I07' 'J07' 'M05' 'M11']
Number of in features:  1245
Number of out features:  2
Binary_Classification
SGD
Epoch 0: Validation loss decreased (inf --> 0.460055).  Saving model ...
	 Train_Loss: 0.5217 Train_Acc: 75.656 Val_Loss: 0.4601  BEST VAL Loss: 0.4601  Val_Acc: 77.244

Epoch 1: Validation loss decreased (0.460055 --> 0.412806).  Saving model ...
	 Train_Loss: 0.4714 Train_Acc: 80.973 Val_Loss: 0.4128  BEST VAL Loss: 0.4128  Val_Acc: 84.424

Epoch 2: Validation loss did not decrease
	 Train_Loss: 0.4392 Train_Acc: 83.422 Val_Loss: 0.4987  BEST VAL Loss: 0.4128  Val_Acc: 71.333

Epoch 3: Validation loss did not decrease
	 Train_Loss: 0.4180 Train_Acc: 84.423 Val_Loss: 0.5897  BEST VAL Loss: 0.4128  Val_Acc: 70.370

Epoch 4: Validation loss did not decrease
	 Train_Loss: 0.4035 Train_Acc: 84.879 Val_Loss: 0.5321  BEST VAL Loss: 0.4128  Val_Acc: 86.964

Epoch 5: Validation loss did not decrease
	 Train_Loss: 0.3901 Train_Acc: 85.874 Val_Loss: 0.4930  BEST VAL Loss: 0.4128  Val_Acc: 86.940

Epoch 6: Validation loss did not decrease
	 Train_Loss: 0.3791 Train_Acc: 86.275 Val_Loss: 0.4650  BEST VAL Loss: 0.4128  Val_Acc: 87.301

Epoch 7: Validation loss did not decrease
	 Train_Loss: 0.3703 Train_Acc: 86.518 Val_Loss: 0.5490  BEST VAL Loss: 0.4128  Val_Acc: 67.764

Epoch 8: Validation loss did not decrease
	 Train_Loss: 0.3641 Train_Acc: 86.443 Val_Loss: 0.5267  BEST VAL Loss: 0.4128  Val_Acc: 83.239

Epoch 9: Validation loss did not decrease
	 Train_Loss: 0.3578 Train_Acc: 86.888 Val_Loss: 0.5309  BEST VAL Loss: 0.4128  Val_Acc: 77.189

Epoch 10: Validation loss did not decrease
	 Train_Loss: 0.3528 Train_Acc: 86.981 Val_Loss: 0.5419  BEST VAL Loss: 0.4128  Val_Acc: 74.347

Epoch 11: Validation loss did not decrease
	 Train_Loss: 0.3482 Train_Acc: 87.016 Val_Loss: 0.5406  BEST VAL Loss: 0.4128  Val_Acc: 76.133

Epoch 12: Validation loss did not decrease
	 Train_Loss: 0.3440 Train_Acc: 87.214 Val_Loss: 0.5219  BEST VAL Loss: 0.4128  Val_Acc: 86.634

Epoch 13: Validation loss did not decrease
	 Train_Loss: 0.3399 Train_Acc: 87.548 Val_Loss: 0.5230  BEST VAL Loss: 0.4128  Val_Acc: 76.599

Epoch 14: Validation loss did not decrease
	 Train_Loss: 0.3368 Train_Acc: 87.244 Val_Loss: 0.5288  BEST VAL Loss: 0.4128  Val_Acc: 80.370

Epoch 15: Validation loss did not decrease
	 Train_Loss: 0.3347 Train_Acc: 87.056 Val_Loss: 0.5166  BEST VAL Loss: 0.4128  Val_Acc: 85.162

Epoch 16: Validation loss did not decrease
	 Train_Loss: 0.3320 Train_Acc: 87.399 Val_Loss: 0.5020  BEST VAL Loss: 0.4128  Val_Acc: 88.117

Epoch 17: Validation loss did not decrease
Early stopped at epoch : 17
Flagellin_1.000_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/PBMC
Flagellin_1.000_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.73      0.78      0.75    149884
           1       0.27      0.22      0.24     56123

    accuracy                           0.63    206007
   macro avg       0.50      0.50      0.50    206007
weighted avg       0.60      0.63      0.61    206007

Flagellin_1.000_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/PBMC
Flagellin_1.000_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.73      0.79      0.76     18736
           1       0.28      0.22      0.25      7015

    accuracy                           0.63     25751
   macro avg       0.50      0.50      0.50     25751
weighted avg       0.61      0.63      0.62     25751

Flagellin_1.000_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/PBMC
Flagellin_1.000_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.73      0.78      0.75     18736
           1       0.26      0.21      0.23      7015

    accuracy                           0.63     25751
   macro avg       0.49      0.50      0.49     25751
weighted avg       0.60      0.63      0.61     25751

              precision    recall  f1-score   support

           0       0.73      0.78      0.75     18736
           1       0.26      0.21      0.23      7015

    accuracy                           0.63     25751
   macro avg       0.49      0.50      0.49     25751
weighted avg       0.60      0.63      0.61     25751

Flagellin_1.000_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/PBMC
Flagellin_1.000_DMSO_0.025_vs_DMSO_0.100_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.45      0.75      0.56     27774
           1       0.55      0.25      0.34     34394

    accuracy                           0.47     62168
   macro avg       0.50      0.50      0.45     62168
weighted avg       0.50      0.47      0.44     62168

              precision    recall  f1-score   support

           0       0.45      0.75      0.56     27774
           1       0.55      0.25      0.34     34394

    accuracy                           0.47     62168
   macro avg       0.50      0.50      0.45     62168
weighted avg       0.50      0.47      0.44     62168

completed
