[NbConvertApp] WARNING | Config option `kernel_spec_manager_class` not recognized by `NbConvertApp`.
[NbConvertApp] Converting notebook ../notebooks/Hyperparameter_Optimization_model_multi-class.ipynb to script
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3e2c848c' detected. Corrected to '98f31996'.
  validate(nb)
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3c53f7e4' detected. Corrected to 'c0cff247'.
  validate(nb)
[NbConvertApp] Writing 14456 bytes to Hyperparameter_Optimization_model_multi-class.py
[NbConvertApp] Converting notebook ../notebooks/Hyperparameter_Optimization_model_regression.ipynb to script
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3e2c848c' detected. Corrected to '41680b7b'.
  validate(nb)
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3c53f7e4' detected. Corrected to '4f6ec3ef'.
  validate(nb)
[NbConvertApp] Writing 12852 bytes to Hyperparameter_Optimization_model_regression.py
[NbConvertApp] Converting notebook ../notebooks/train_binary_model.ipynb to script
[NbConvertApp] Writing 19547 bytes to train_binary_model.py
cell_type: SHSY5Y control_name: LPS_0.010_DMSO_0.025 treatment_name: LPS_10.000_DMSO_0.025 shuffle: True
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:997: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y1], palette="blue", label="Train")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:998: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y2], palette="orange", label="Validation")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:997: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y1], palette="blue", label="Train")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:998: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y2], palette="orange", label="Validation")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1018: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1324: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1324: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
CELL_TYPE: SHSY5Y
CONTROL_NAME: LPS_0.010_DMSO_0.025
TREATMENT_NAME: LPS_10.000_DMSO_0.025
SHUFFLE: True
True
Selected Catagories are:
['LPS_0.010_DMSO_0.025' 'LPS_10.000_DMSO_0.025']
The dimensions of the data are: (32669, 1276)
Number of total missing values across all columns: 65338
Data Subset Is Off
Wells held out for testing: ['B20' 'E21']
Wells to use for training, validation, and testing ['B16' 'E16' 'B17' 'E17' 'E20' 'B21']
Number of in features:  1251
Number of out features:  2
Binary_Classification
Adam
Epoch 0: Validation loss decreased (inf --> 0.620800).  Saving model ...
	 Train_Loss: 0.6986 Train_Acc: 58.716 Val_Loss: 0.6208  BEST VAL Loss: 0.6208  Val_Acc: 67.151

Epoch 1: Validation loss decreased (0.620800 --> 0.596818).  Saving model ...
	 Train_Loss: 0.6570 Train_Acc: 66.858 Val_Loss: 0.5968  BEST VAL Loss: 0.5968  Val_Acc: 70.702

Epoch 2: Validation loss decreased (0.596818 --> 0.581980).  Saving model ...
	 Train_Loss: 0.6317 Train_Acc: 69.810 Val_Loss: 0.5820  BEST VAL Loss: 0.5820  Val_Acc: 71.227

Epoch 3: Validation loss decreased (0.581980 --> 0.569704).  Saving model ...
	 Train_Loss: 0.6133 Train_Acc: 71.732 Val_Loss: 0.5697  BEST VAL Loss: 0.5697  Val_Acc: 73.406

Epoch 4: Validation loss decreased (0.569704 --> 0.559901).  Saving model ...
	 Train_Loss: 0.5991 Train_Acc: 72.509 Val_Loss: 0.5599  BEST VAL Loss: 0.5599  Val_Acc: 74.052

Epoch 5: Validation loss decreased (0.559901 --> 0.551210).  Saving model ...
	 Train_Loss: 0.5874 Train_Acc: 73.457 Val_Loss: 0.5512  BEST VAL Loss: 0.5512  Val_Acc: 74.092

Epoch 6: Validation loss decreased (0.551210 --> 0.543764).  Saving model ...
	 Train_Loss: 0.5773 Train_Acc: 74.542 Val_Loss: 0.5438  BEST VAL Loss: 0.5438  Val_Acc: 74.778

Epoch 7: Validation loss decreased (0.543764 --> 0.537459).  Saving model ...
	 Train_Loss: 0.5690 Train_Acc: 74.678 Val_Loss: 0.5375  BEST VAL Loss: 0.5375  Val_Acc: 75.868

Epoch 8: Validation loss decreased (0.537459 --> 0.533260).  Saving model ...
	 Train_Loss: 0.5615 Train_Acc: 75.662 Val_Loss: 0.5333  BEST VAL Loss: 0.5333  Val_Acc: 75.948

Epoch 9: Validation loss decreased (0.533260 --> 0.529441).  Saving model ...
	 Train_Loss: 0.5554 Train_Acc: 75.592 Val_Loss: 0.5294  BEST VAL Loss: 0.5294  Val_Acc: 76.150

Epoch 10: Validation loss decreased (0.529441 --> 0.524885).  Saving model ...
	 Train_Loss: 0.5498 Train_Acc: 76.131 Val_Loss: 0.5249  BEST VAL Loss: 0.5249  Val_Acc: 76.796

Epoch 11: Validation loss decreased (0.524885 --> 0.521638).  Saving model ...
	 Train_Loss: 0.5442 Train_Acc: 77.080 Val_Loss: 0.5216  BEST VAL Loss: 0.5216  Val_Acc: 75.827

Epoch 12: Validation loss decreased (0.521638 --> 0.518279).  Saving model ...
	 Train_Loss: 0.5392 Train_Acc: 77.070 Val_Loss: 0.5183  BEST VAL Loss: 0.5183  Val_Acc: 76.352

Epoch 13: Validation loss decreased (0.518279 --> 0.515218).  Saving model ...
	 Train_Loss: 0.5345 Train_Acc: 77.378 Val_Loss: 0.5152  BEST VAL Loss: 0.5152  Val_Acc: 77.078

Epoch 14: Validation loss decreased (0.515218 --> 0.512560).  Saving model ...
	 Train_Loss: 0.5302 Train_Acc: 77.524 Val_Loss: 0.5126  BEST VAL Loss: 0.5126  Val_Acc: 77.078

Epoch 15: Validation loss decreased (0.512560 --> 0.510941).  Saving model ...
	 Train_Loss: 0.5260 Train_Acc: 77.867 Val_Loss: 0.5109  BEST VAL Loss: 0.5109  Val_Acc: 76.513

Epoch 16: Validation loss decreased (0.510941 --> 0.508798).  Saving model ...
	 Train_Loss: 0.5225 Train_Acc: 77.822 Val_Loss: 0.5088  BEST VAL Loss: 0.5088  Val_Acc: 76.796

Epoch 17: Validation loss decreased (0.508798 --> 0.507350).  Saving model ...
	 Train_Loss: 0.5188 Train_Acc: 78.533 Val_Loss: 0.5074  BEST VAL Loss: 0.5074  Val_Acc: 77.522

Epoch 18: Validation loss decreased (0.507350 --> 0.505450).  Saving model ...
	 Train_Loss: 0.5155 Train_Acc: 78.477 Val_Loss: 0.5054  BEST VAL Loss: 0.5054  Val_Acc: 77.643

Epoch 19: Validation loss decreased (0.505450 --> 0.503932).  Saving model ...
	 Train_Loss: 0.5122 Train_Acc: 78.790 Val_Loss: 0.5039  BEST VAL Loss: 0.5039  Val_Acc: 76.957

Epoch 20: Validation loss decreased (0.503932 --> 0.502957).  Saving model ...
	 Train_Loss: 0.5093 Train_Acc: 78.558 Val_Loss: 0.5030  BEST VAL Loss: 0.5030  Val_Acc: 76.312

Epoch 21: Validation loss decreased (0.502957 --> 0.501250).  Saving model ...
	 Train_Loss: 0.5062 Train_Acc: 79.194 Val_Loss: 0.5012  BEST VAL Loss: 0.5012  Val_Acc: 76.998

Epoch 22: Validation loss decreased (0.501250 --> 0.500468).  Saving model ...
	 Train_Loss: 0.5032 Train_Acc: 79.623 Val_Loss: 0.5005  BEST VAL Loss: 0.5005  Val_Acc: 77.441

Epoch 23: Validation loss decreased (0.500468 --> 0.499208).  Saving model ...
	 Train_Loss: 0.5003 Train_Acc: 79.981 Val_Loss: 0.4992  BEST VAL Loss: 0.4992  Val_Acc: 77.724

Epoch 24: Validation loss decreased (0.499208 --> 0.498311).  Saving model ...
	 Train_Loss: 0.4975 Train_Acc: 79.703 Val_Loss: 0.4983  BEST VAL Loss: 0.4983  Val_Acc: 77.280

Epoch 25: Validation loss decreased (0.498311 --> 0.497468).  Saving model ...
	 Train_Loss: 0.4949 Train_Acc: 79.905 Val_Loss: 0.4975  BEST VAL Loss: 0.4975  Val_Acc: 77.563

Epoch 26: Validation loss decreased (0.497468 --> 0.496823).  Saving model ...
	 Train_Loss: 0.4924 Train_Acc: 80.228 Val_Loss: 0.4968  BEST VAL Loss: 0.4968  Val_Acc: 77.563

Epoch 27: Validation loss decreased (0.496823 --> 0.496290).  Saving model ...
	 Train_Loss: 0.4901 Train_Acc: 80.329 Val_Loss: 0.4963  BEST VAL Loss: 0.4963  Val_Acc: 77.119

Epoch 28: Validation loss decreased (0.496290 --> 0.495730).  Saving model ...
	 Train_Loss: 0.4880 Train_Acc: 80.021 Val_Loss: 0.4957  BEST VAL Loss: 0.4957  Val_Acc: 77.805

Epoch 29: Validation loss decreased (0.495730 --> 0.495338).  Saving model ...
	 Train_Loss: 0.4859 Train_Acc: 80.218 Val_Loss: 0.4953  BEST VAL Loss: 0.4953  Val_Acc: 76.755

Epoch 30: Validation loss decreased (0.495338 --> 0.494896).  Saving model ...
	 Train_Loss: 0.4839 Train_Acc: 80.062 Val_Loss: 0.4949  BEST VAL Loss: 0.4949  Val_Acc: 77.966

Epoch 31: Validation loss decreased (0.494896 --> 0.494270).  Saving model ...
	 Train_Loss: 0.4819 Train_Acc: 80.294 Val_Loss: 0.4943  BEST VAL Loss: 0.4943  Val_Acc: 77.522

Epoch 32: Validation loss decreased (0.494270 --> 0.493924).  Saving model ...
	 Train_Loss: 0.4800 Train_Acc: 80.622 Val_Loss: 0.4939  BEST VAL Loss: 0.4939  Val_Acc: 77.563

Epoch 33: Validation loss decreased (0.493924 --> 0.493430).  Saving model ...
	 Train_Loss: 0.4781 Train_Acc: 80.828 Val_Loss: 0.4934  BEST VAL Loss: 0.4934  Val_Acc: 77.361

Epoch 34: Validation loss did not decrease
	 Train_Loss: 0.4761 Train_Acc: 81.187 Val_Loss: 0.4935  BEST VAL Loss: 0.4934  Val_Acc: 77.159

Epoch 35: Validation loss decreased (0.493430 --> 0.493235).  Saving model ...
	 Train_Loss: 0.4742 Train_Acc: 81.373 Val_Loss: 0.4932  BEST VAL Loss: 0.4932  Val_Acc: 77.643

Epoch 36: Validation loss did not decrease
	 Train_Loss: 0.4724 Train_Acc: 81.040 Val_Loss: 0.4935  BEST VAL Loss: 0.4932  Val_Acc: 77.280

Epoch 37: Validation loss did not decrease
	 Train_Loss: 0.4708 Train_Acc: 80.833 Val_Loss: 0.4933  BEST VAL Loss: 0.4932  Val_Acc: 77.361

Epoch 38: Validation loss decreased (0.493235 --> 0.493159).  Saving model ...
	 Train_Loss: 0.4692 Train_Acc: 81.252 Val_Loss: 0.4932  BEST VAL Loss: 0.4932  Val_Acc: 76.796

Epoch 39: Validation loss decreased (0.493159 --> 0.493084).  Saving model ...
	 Train_Loss: 0.4675 Train_Acc: 81.368 Val_Loss: 0.4931  BEST VAL Loss: 0.4931  Val_Acc: 76.634

Epoch 40: Validation loss did not decrease
	 Train_Loss: 0.4658 Train_Acc: 81.726 Val_Loss: 0.4934  BEST VAL Loss: 0.4931  Val_Acc: 77.320

Epoch 41: Validation loss did not decrease
	 Train_Loss: 0.4641 Train_Acc: 81.656 Val_Loss: 0.4934  BEST VAL Loss: 0.4931  Val_Acc: 76.998

Epoch 42: Validation loss did not decrease
	 Train_Loss: 0.4625 Train_Acc: 82.155 Val_Loss: 0.4937  BEST VAL Loss: 0.4931  Val_Acc: 77.038

Epoch 43: Validation loss did not decrease
	 Train_Loss: 0.4611 Train_Acc: 81.298 Val_Loss: 0.4940  BEST VAL Loss: 0.4931  Val_Acc: 76.513

Epoch 44: Validation loss did not decrease
	 Train_Loss: 0.4597 Train_Acc: 81.747 Val_Loss: 0.4944  BEST VAL Loss: 0.4931  Val_Acc: 76.877

Epoch 45: Validation loss did not decrease
	 Train_Loss: 0.4583 Train_Acc: 81.878 Val_Loss: 0.4945  BEST VAL Loss: 0.4931  Val_Acc: 76.796

Epoch 46: Validation loss did not decrease
	 Train_Loss: 0.4567 Train_Acc: 82.317 Val_Loss: 0.4945  BEST VAL Loss: 0.4931  Val_Acc: 77.885

Epoch 47: Validation loss did not decrease
	 Train_Loss: 0.4553 Train_Acc: 82.503 Val_Loss: 0.4945  BEST VAL Loss: 0.4931  Val_Acc: 76.513

Epoch 48: Validation loss did not decrease
	 Train_Loss: 0.4539 Train_Acc: 82.075 Val_Loss: 0.4950  BEST VAL Loss: 0.4931  Val_Acc: 77.078

Epoch 49: Validation loss did not decrease
	 Train_Loss: 0.4525 Train_Acc: 82.377 Val_Loss: 0.4951  BEST VAL Loss: 0.4931  Val_Acc: 76.231

Epoch 50: Validation loss did not decrease
	 Train_Loss: 0.4512 Train_Acc: 82.362 Val_Loss: 0.4954  BEST VAL Loss: 0.4931  Val_Acc: 77.522

Epoch 51: Validation loss did not decrease
	 Train_Loss: 0.4499 Train_Acc: 82.418 Val_Loss: 0.4959  BEST VAL Loss: 0.4931  Val_Acc: 76.392

Epoch 52: Validation loss did not decrease
	 Train_Loss: 0.4486 Train_Acc: 82.619 Val_Loss: 0.4965  BEST VAL Loss: 0.4931  Val_Acc: 77.119

Epoch 53: Validation loss did not decrease
	 Train_Loss: 0.4474 Train_Acc: 82.746 Val_Loss: 0.4969  BEST VAL Loss: 0.4931  Val_Acc: 76.352

Epoch 54: Validation loss did not decrease
	 Train_Loss: 0.4462 Train_Acc: 82.549 Val_Loss: 0.4976  BEST VAL Loss: 0.4931  Val_Acc: 76.998

Epoch 55: Validation loss did not decrease
Early stopped at epoch : 55
LPS_0.010_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/SHSY5Y
LPS_0.010_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.50      0.52      0.51      9707
           1       0.52      0.50      0.51     10114

    accuracy                           0.51     19821
   macro avg       0.51      0.51      0.51     19821
weighted avg       0.51      0.51      0.51     19821

LPS_0.010_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/SHSY5Y
LPS_0.010_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.49      0.49      0.49      1214
           1       0.51      0.51      0.51      1264

    accuracy                           0.50      2478
   macro avg       0.50      0.50      0.50      2478
weighted avg       0.50      0.50      0.50      2478

LPS_0.010_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/SHSY5Y
LPS_0.010_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.48      0.51      0.49      1214
           1       0.50      0.47      0.48      1264

    accuracy                           0.49      2478
   macro avg       0.49      0.49      0.49      2478
weighted avg       0.49      0.49      0.49      2478

              precision    recall  f1-score   support

           0       0.48      0.51      0.49      1214
           1       0.50      0.47      0.48      1264

    accuracy                           0.49      2478
   macro avg       0.49      0.49      0.49      2478
weighted avg       0.49      0.49      0.49      2478

LPS_0.010_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/SHSY5Y
LPS_0.010_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.47      0.48      0.47      3724
           1       0.52      0.51      0.52      4168

    accuracy                           0.50      7892
   macro avg       0.50      0.50      0.50      7892
weighted avg       0.50      0.50      0.50      7892

              precision    recall  f1-score   support

           0       0.47      0.48      0.47      3724
           1       0.52      0.51      0.52      4168

    accuracy                           0.50      7892
   macro avg       0.50      0.50      0.50      7892
weighted avg       0.50      0.50      0.50      7892

completed
