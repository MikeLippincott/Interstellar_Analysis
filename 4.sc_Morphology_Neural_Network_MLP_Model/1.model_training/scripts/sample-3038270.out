[NbConvertApp] WARNING | Config option `kernel_spec_manager_class` not recognized by `NbConvertApp`.
[NbConvertApp] Converting notebook ../notebooks/Hyperparameter_Optimization_model_multi-class.ipynb to script
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3e2c848c' detected. Corrected to '5e85da78'.
  validate(nb)
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3c53f7e4' detected. Corrected to 'c6b2a027'.
  validate(nb)
[NbConvertApp] Writing 14456 bytes to Hyperparameter_Optimization_model_multi-class.py
[NbConvertApp] Converting notebook ../notebooks/Hyperparameter_Optimization_model_regression.ipynb to script
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3e2c848c' detected. Corrected to 'b0aba1f6'.
  validate(nb)
/projects/mlippincott@xsede.org/software/anaconda/envs/Interstellar/lib/python3.10/site-packages/nbformat/__init__.py:93: DuplicateCellId: Non-unique cell id '3c53f7e4' detected. Corrected to '4d73bf4f'.
  validate(nb)
[NbConvertApp] Writing 12852 bytes to Hyperparameter_Optimization_model_regression.py
[NbConvertApp] Converting notebook ../notebooks/train_binary_model.ipynb to script
[NbConvertApp] Writing 19547 bytes to train_binary_model.py
cell_type: PBMC control_name: H2O2_100.000_DMSO_0.025 treatment_name: LPS_10.000_DMSO_0.025 shuffle: True
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:997: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y1], palette="blue", label="Train")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:998: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y2], palette="orange", label="Validation")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:997: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y1], palette="blue", label="Train")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:998: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.
  sns.lineplot(x=df[x], y=df[y2], palette="orange", label="Validation")
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1018: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1324: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
/gpfs/alpine1/scratch/mlippincott@xsede.org/Interstellar_Analysis/4.sc_Morphology_Neural_Network_MLP_Model/1.model_training/scripts/../../MLP_utils/utils.py:1324: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
CELL_TYPE: PBMC
CONTROL_NAME: H2O2_100.000_DMSO_0.025
TREATMENT_NAME: LPS_10.000_DMSO_0.025
SHUFFLE: True
True
Selected Catagories are:
['LPS_10.000_DMSO_0.025' 'H2O2_100.000_DMSO_0.025']
The dimensions of the data are: (397026, 1270)
Number of total missing values across all columns: 794052
Data Subset Is Off
Wells held out for testing: ['E09' 'I10']
Wells to use for training, validation, and testing ['E02' 'E03' 'E08' 'H04' 'I04' 'H05' 'I05' 'H10' 'H11' 'I11']
Number of in features:  1245
Number of out features:  2
Binary_Classification
Adam
Epoch 0: Validation loss decreased (inf --> 0.440324).  Saving model ...
	 Train_Loss: 0.5469 Train_Acc: 70.727 Val_Loss: 0.4403  BEST VAL Loss: 0.4403  Val_Acc: 79.570

Epoch 1: Validation loss decreased (0.440324 --> 0.420032).  Saving model ...
	 Train_Loss: 0.5037 Train_Acc: 78.370 Val_Loss: 0.4200  BEST VAL Loss: 0.4200  Val_Acc: 81.774

Epoch 2: Validation loss did not decrease
	 Train_Loss: 0.4854 Train_Acc: 78.111 Val_Loss: 0.4207  BEST VAL Loss: 0.4200  Val_Acc: 80.805

Epoch 3: Validation loss decreased (0.420032 --> 0.411045).  Saving model ...
	 Train_Loss: 0.4755 Train_Acc: 78.069 Val_Loss: 0.4110  BEST VAL Loss: 0.4110  Val_Acc: 81.780

Epoch 4: Validation loss decreased (0.411045 --> 0.404708).  Saving model ...
	 Train_Loss: 0.4654 Train_Acc: 79.201 Val_Loss: 0.4047  BEST VAL Loss: 0.4047  Val_Acc: 81.089

Epoch 5: Validation loss decreased (0.404708 --> 0.400921).  Saving model ...
	 Train_Loss: 0.4589 Train_Acc: 79.289 Val_Loss: 0.4009  BEST VAL Loss: 0.4009  Val_Acc: 81.080

Epoch 6: Validation loss decreased (0.400921 --> 0.395257).  Saving model ...
	 Train_Loss: 0.4533 Train_Acc: 79.582 Val_Loss: 0.3953  BEST VAL Loss: 0.3953  Val_Acc: 83.987

Epoch 7: Validation loss decreased (0.395257 --> 0.393507).  Saving model ...
	 Train_Loss: 0.4496 Train_Acc: 79.196 Val_Loss: 0.3935  BEST VAL Loss: 0.3935  Val_Acc: 81.291

Epoch 8: Validation loss decreased (0.393507 --> 0.391163).  Saving model ...
	 Train_Loss: 0.4467 Train_Acc: 79.324 Val_Loss: 0.3912  BEST VAL Loss: 0.3912  Val_Acc: 81.835

Epoch 9: Validation loss decreased (0.391163 --> 0.390053).  Saving model ...
	 Train_Loss: 0.4444 Train_Acc: 78.614 Val_Loss: 0.3901  BEST VAL Loss: 0.3901  Val_Acc: 84.390

Epoch 10: Validation loss did not decrease
	 Train_Loss: 0.4434 Train_Acc: 78.232 Val_Loss: 0.3916  BEST VAL Loss: 0.3901  Val_Acc: 80.762

Epoch 11: Validation loss did not decrease
	 Train_Loss: 0.4442 Train_Acc: 78.582 Val_Loss: 0.3941  BEST VAL Loss: 0.3901  Val_Acc: 81.120

Epoch 12: Validation loss did not decrease
	 Train_Loss: 0.4437 Train_Acc: 78.804 Val_Loss: 0.3936  BEST VAL Loss: 0.3901  Val_Acc: 80.444

Epoch 13: Validation loss did not decrease
	 Train_Loss: 0.4430 Train_Acc: 79.170 Val_Loss: 0.3923  BEST VAL Loss: 0.3901  Val_Acc: 81.086

Epoch 14: Validation loss did not decrease
	 Train_Loss: 0.4427 Train_Acc: 78.759 Val_Loss: 0.3917  BEST VAL Loss: 0.3901  Val_Acc: 81.086

Epoch 15: Validation loss did not decrease
	 Train_Loss: 0.4418 Train_Acc: 79.014 Val_Loss: 0.3901  BEST VAL Loss: 0.3901  Val_Acc: 81.636

Epoch 16: Validation loss decreased (0.390053 --> 0.389401).  Saving model ...
	 Train_Loss: 0.4416 Train_Acc: 78.648 Val_Loss: 0.3894  BEST VAL Loss: 0.3894  Val_Acc: 81.872

Epoch 17: Validation loss decreased (0.389401 --> 0.388575).  Saving model ...
	 Train_Loss: 0.4425 Train_Acc: 78.610 Val_Loss: 0.3886  BEST VAL Loss: 0.3886  Val_Acc: 81.930

Epoch 18: Validation loss did not decrease
	 Train_Loss: 0.4427 Train_Acc: 78.898 Val_Loss: 0.4031  BEST VAL Loss: 0.3886  Val_Acc: 79.946

Epoch 19: Validation loss did not decrease
	 Train_Loss: 0.4475 Train_Acc: 77.373 Val_Loss: 0.4087  BEST VAL Loss: 0.3886  Val_Acc: 79.121

Epoch 20: Validation loss did not decrease
	 Train_Loss: 0.4519 Train_Acc: 76.950 Val_Loss: 0.4132  BEST VAL Loss: 0.3886  Val_Acc: 80.188

Epoch 21: Validation loss did not decrease
	 Train_Loss: 0.4556 Train_Acc: 77.347 Val_Loss: 0.4181  BEST VAL Loss: 0.3886  Val_Acc: 79.390

Epoch 22: Validation loss did not decrease
	 Train_Loss: 0.4592 Train_Acc: 76.954 Val_Loss: 0.4227  BEST VAL Loss: 0.3886  Val_Acc: 78.482

Epoch 23: Validation loss did not decrease
	 Train_Loss: 0.4624 Train_Acc: 77.198 Val_Loss: 0.4264  BEST VAL Loss: 0.3886  Val_Acc: 79.433

Epoch 24: Validation loss did not decrease
	 Train_Loss: 0.4653 Train_Acc: 77.307 Val_Loss: 0.4295  BEST VAL Loss: 0.3886  Val_Acc: 80.227

Epoch 25: Validation loss did not decrease
	 Train_Loss: 0.4679 Train_Acc: 77.428 Val_Loss: 0.4323  BEST VAL Loss: 0.3886  Val_Acc: 80.218

Epoch 26: Validation loss did not decrease
	 Train_Loss: 0.4701 Train_Acc: 77.695 Val_Loss: 0.4346  BEST VAL Loss: 0.3886  Val_Acc: 81.095

Epoch 27: Validation loss did not decrease
	 Train_Loss: 0.4723 Train_Acc: 77.441 Val_Loss: 0.4371  BEST VAL Loss: 0.3886  Val_Acc: 80.191

Epoch 28: Validation loss did not decrease
	 Train_Loss: 0.4743 Train_Acc: 77.533 Val_Loss: 0.4392  BEST VAL Loss: 0.3886  Val_Acc: 80.869

Epoch 29: Validation loss did not decrease
	 Train_Loss: 0.4764 Train_Acc: 77.276 Val_Loss: 0.4444  BEST VAL Loss: 0.3886  Val_Acc: 74.817

Epoch 30: Validation loss did not decrease
	 Train_Loss: 0.4784 Train_Acc: 76.718 Val_Loss: 0.4467  BEST VAL Loss: 0.3886  Val_Acc: 79.476

Epoch 31: Validation loss did not decrease
	 Train_Loss: 0.4799 Train_Acc: 77.985 Val_Loss: 0.4487  BEST VAL Loss: 0.3886  Val_Acc: 79.622

Epoch 32: Validation loss did not decrease
	 Train_Loss: 0.4815 Train_Acc: 77.654 Val_Loss: 0.4501  BEST VAL Loss: 0.3886  Val_Acc: 81.077

Epoch 33: Validation loss did not decrease
Early stopped at epoch : 33
H2O2_100.000_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/PBMC
H2O2_100.000_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.65      0.77      0.70    169562
           1       0.35      0.23      0.28     92173

    accuracy                           0.58    261735
   macro avg       0.50      0.50      0.49    261735
weighted avg       0.54      0.58      0.55    261735

H2O2_100.000_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/PBMC
H2O2_100.000_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.65      0.77      0.71     21195
           1       0.36      0.23      0.28     11522

    accuracy                           0.58     32717
   macro avg       0.50      0.50      0.49     32717
weighted avg       0.55      0.58      0.56     32717

H2O2_100.000_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/PBMC
H2O2_100.000_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.65      0.77      0.70     21195
           1       0.35      0.23      0.28     11522

    accuracy                           0.58     32717
   macro avg       0.50      0.50      0.49     32717
weighted avg       0.54      0.58      0.55     32717

              precision    recall  f1-score   support

           0       0.65      0.77      0.70     21195
           1       0.35      0.23      0.28     11522

    accuracy                           0.58     32717
   macro avg       0.50      0.50      0.49     32717
weighted avg       0.54      0.58      0.55     32717

H2O2_100.000_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
../../trained_models/model_save_states/Binary_Classification/PBMC
H2O2_100.000_DMSO_0.025_vs_LPS_10.000_DMSO_0.025_shuffle
              precision    recall  f1-score   support

           0       0.41      0.75      0.53     28584
           1       0.59      0.24      0.34     41273

    accuracy                           0.45     69857
   macro avg       0.50      0.50      0.44     69857
weighted avg       0.51      0.45      0.42     69857

              precision    recall  f1-score   support

           0       0.41      0.75      0.53     28584
           1       0.59      0.24      0.34     41273

    accuracy                           0.45     69857
   macro avg       0.50      0.50      0.44     69857
weighted avg       0.51      0.45      0.42     69857

completed
